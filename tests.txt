➜  metasploit-framework git:(ruby-3.0-spike) ✗ bundle exec rspec
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
Run options: include {:focus=>true}

All examples were filtered out; ignoring {:focus=>true}

Randomized with seed 48928
Metasploit::Framework::LoginScanner::Result .......
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::OutputDebugString ........
Net::DNS::RR::Classes .*.....
Metasploit::Framework::LoginScanner::DB2 ............
From: /Users/adfoster/Documents/code/metasploit-framework/spec/support/shared/examples/metasploit/framework/login_scanner/login_scanner_base.rb:161 :

    156:       end
    157: 
    158:       it 'is not valid for DNS name that cannot be resolved' do
    159:         login_scanner.host = 'nosuchplace.metasploit.com'
    160:         require 'pry'; binding.pry
 => 161:         expect(login_scanner).to_not be_valid
    162:         expect(login_scanner.errors[:host]).to include "could not be resolved"
    163:       end
    164: 
    165:       it 'is valid for a valid IP address' do
    166:         login_scanner.host = '127.0.0.1'

[1] pry(#<RSpec::ExampleGroups::MetasploitFrameworkLoginScannerDB2::BehavesLikeMetasploitFrameworkLoginScannerBase::Validations::Host>)> disable-pry
..........................................
Msf::Auxiliary::Arista FFFFFFFFFFF

  1) Msf::Auxiliary::Arista deals with SNMP details saves RW correct
     Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  2) Msf::Auxiliary::Arista deals with SNMP details saves RO correct
     Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  3) Msf::Auxiliary::Arista#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
     Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:55:in `block (3 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  4) Msf::Auxiliary::Arista#create_credential_and_login creates a Metasploit::Credential::Login
     Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:55:in `block (3 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  5) Msf::Auxiliary::Arista#arista_eos_config_eater deals with aaa root secret
     Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  6) Msf::Auxiliary::Arista#arista_eos_config_eater deals with enable passwords
     Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  7) Msf::Auxiliary::Arista#arista_eos_config_eater deals with model and version
     Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  8) Msf::Auxiliary::Arista#arista_eos_config_eater deals with hostname
     Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  9) Msf::Auxiliary::Arista deals with user details deals with no roles and md5 passwords
     Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
     
     KeyError:
       Factory not registered: "mdm_workspace"
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
     # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
     # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
     # ------------------
     # --- Caused by: ---
     # KeyError:
     #   key not found: "mdm_workspace"
     #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  10) Msf::Auxiliary::Arista deals with user details deals with no roles and plaintext passwords
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  11) Msf::Auxiliary::Arista deals with user details deals with roles and sha512 passwords
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/arista_spec.rb:44:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Msf::OptInt ...............
Metasploit::Framework::CredentialCollection ................
Metasploit::Framework::LoginScanner::VNC ...........................................................
Rex::Post::Meterpreter::Extensions::Stdapi::UI ....
Rex::Proto::Kerberos::CredentialCache::Time .
modules .....................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
Msf::Exploit::Remote::Kerberos::Client::TgsRequest .........................
Msf::Exploit::CmdStager ........................................
Rex::Proto::Kerberos::Model::Checksum .
MetasploitPayloads .
Metasploit::Framework::LoginScanner::HTTP ...................................................
Rex::Parser::NmapXMLStreamParser ....
Msf::Ui::Debug .........F................

  12) Msf::Ui::Debug correctly retrieves version information with DB connected via local connection
      Failure/Error: allow(::ApplicationRecord).to receive(:connection_pool).and_return(connection_pool)
      
      NameError:
        uninitialized constant ApplicationRecord
      # ./spec/lib/msf/debug_spec.rb:1352:in `block (2 levels) in <top (required)>'
RuboCop::Cop::Lint::ModuleDisclosureDateFormat ....
Metasploit::Framework::LoginScanner::VMAUTHD ......................................................
Rex::Proto::Kerberos::CredentialCache::Credential .
Msf::Exe::SegmentAppender ...............
Rex::Post::Meterpreter::Extensions::Priv::Priv ......
Metasploit::Framework::PasswordCracker::Cracker ...................................
Msf::Exploit::SQLi::MySQLi::Common ............
Msf::Modules::Loader::Directory .........
Rex::Proto::Quake .........
Net::DNS::Names .........
Msfupdate ..........................................
Metasploit::Framework::PasswordCracker::InvalidWordlist ...
Metasploit::Framework::LoginScanner::Caidao .......................................................
Msf::OptHTTPRhostURL ...........................
Msf::Module::Target .
Msf::Exploit::Remote::Kerberos::Client::TgsResponse ...
Msf::Exploit::Remote::HTTP::Joomla::Base .
RuboCop::Cop::Layout::ExtraSpacingWithBinDataIgnored ..
Msf::Exploit::Remote::SMB::Server::Share ..
Rex::Proto::Sms::Model::Smtp .......
Metasploit::Framework::LoginScanner::OctopusDeploy ..................................................
Msf::Ui::Console::TablePrint::RankStyler ..
Metasploit::Framework::LoginScanner::Invalid ...
Rex::Post::Meterpreter::PacketParser .
Metasploit::Framework::LoginScanner::ManageEngineDesktopCentral ....................................................
Msf::Util::DotNetDeserialization ........triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 10
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 0
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 4
triggered choice issue BinData::Uint8 -- 11
triggered choice issue BinData::Uint8 -- 11
...................triggered choice issue BinData::Uint8 -- 0
.triggered choice issue BinData::Uint8 -- 11
..triggered choice issue BinData::Uint8 -- 11
...
Msf::Exploit::Remote::Java::Rmi::Client .......
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::FakeFunction ......
Rex::Proto::Rmi::Model::UniqueIdentifier .....
Metasploit::Framework::Credential .......................
Metasploit::Framework::LoginScanner ........................
Msf::DataStore ................
Rex::Proto::Kerberos::Pac::LogonInfo .
Msf::ServiceState ....
Msf::Exploit::Remote::Java::Rmi::Client::Jmx::Server::Parser .....
Rex::Proto::Kerberos::Client .....
Rex::Proto::Kerberos::Model::PreAuthData ........
Rex::ImageSource::Memory ..............................
Rex::Proto::Rmi::Model::PingAck ...
Msf::Exploit::Remote::Kerberos::Client::Base ............
Msf::Auxiliary::F5 FFFFFFF

  13) Msf::Auxiliary::F5#f5_config_eater deals with user passwords
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/f5_spec.rb:44:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  14) Msf::Auxiliary::F5#f5_config_eater deals with host information
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/f5_spec.rb:44:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  15) Msf::Auxiliary::F5#f5_config_eater deals with system keys
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/f5_spec.rb:44:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  16) Msf::Auxiliary::F5#f5_config_eater deals with SSL Keys
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/f5_spec.rb:44:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  17) Msf::Auxiliary::F5#f5_config_eater deals with SNMP
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/f5_spec.rb:44:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  18) Msf::Auxiliary::F5#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
      Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/f5_spec.rb:55:in `block (3 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  19) Msf::Auxiliary::F5#create_credential_and_login creates a Metasploit::Credential::Login
      Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/f5_spec.rb:55:in `block (3 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Metasploit::Framework::LoginScanner::MyBookLive ..................................................
Rex::Post::Meterpreter::GroupTlv ......................................**.*
Msf::Exploit::Remote::SMB::Server::Share ......
Msf::OptAddress ........./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
...
Msf::Exploit::Remote::HTTP::JBoss::Base ..............
Egghunter 
.
.
.....
modules/payloads ...................................................................................................................................................................................../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
........................................................................................................................................................................................................................................................................................................................................................./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
................................................................................../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
....................../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
.................................................................................................../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
............................../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
........................................................................................................................../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
............................................................................................................/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
............................................................................................................/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
......../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
......../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
......................................................................................................................................................./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
......................................................................................................................................................................................................................................................................................................................................................................................................................................................................................../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
..........................................................................................................................................................
Metasploit::Framework::LoginScanner::IPBoard .........................................................
Rex::Proto::Nuuo::ClientRequest ..............
Msf::DBExport FFFFFFFFFFFFFFFFFFFFFFFF

  20) Msf::DBExport#extract_module_detail_info without Mdm::Module::Details should not write anything to report_file
      Failure/Error:
        FactoryBot.create(
            :mdm_workspace
        )
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:16:in `block (2 levels) in <top (required)>'
      # ./spec/lib/msf/db_manager/export_spec.rb:8:in `block (2 levels) in <top (required)>'
      # ./spec/lib/msf/db_manager/export_spec.rb:27:in `block (3 levels) in <top (required)>'
      # ./spec/lib/msf/db_manager/export_spec.rb:101:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  21) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details should have module_detail tag for each Mdm::Module::Detail
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  22) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#file for file content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:85
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  23) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#file nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:85
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  24) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#rank for rank content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:92
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  25) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#rank nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:92
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  26) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail /disclosure-date should have Mdm::Module::Detail#disclosure_date present
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  27) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail /disclosure-date should have Mdm::Module::Detail#disclosure_date from disclosure-date content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  28) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#fullname for fullname content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:86
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  29) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#fullname nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:86
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  30) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#privileged nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:91
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  31) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#privileged for privileged content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:91
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  32) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#license for license content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:87
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  33) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#license nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:87
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  34) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#mtype for mtype content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:89
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  35) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#mtype nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:89
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  36) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#description nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:71
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  37) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#description for description content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:71
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  38) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#refname for refname content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:93
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  39) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#refname nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:93
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  40) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#mtime for mtime content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:88
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  41) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#mtime nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:88
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  42) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#name for name content
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:90
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  43) Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#name nil
      Failure/Error:
        FactoryBot.create_list(
            :mdm_module_detail,
            module_detail_count
        )
      
      KeyError:
        Factory not registered: "mdm_module_detail"
      Shared Example Group: "Msf::DBExport#extract_module_detail_info module_detail child" called from ./spec/lib/msf/db_manager/export_spec.rb:90
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
      # ./spec/lib/msf/db_manager/export_spec.rb:44:in `block (4 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_module_detail"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Msf::Module::Reference .
Msf::OptFloat .............
Rex::Proto::Kerberos::Model::EncKdcResponse ............
Msf::PayloadGenerator ........................*..................................................
Msf::Post::Windows::Runas ......................
Msf::EncodedPayload ..............
Msf::Exploit::Remote::HTTP::JBoss::DeploymentFileRepository ........
Msf::Exploit::Remote::HTTP::Wordpress::Base .....
Msf::OptRaw .....
Msf::Exploit::Remote::Java::Rmi::Client::Registry::Builder ......
Msf::Modules::Error .........
Rex::Proto::Rmi::Model::ReturnData ....
Msf::Post::Windows::Priv F...F

  44) Msf::Post::Windows::Priv#capture_lsa_key with a Vista or newer registry should produce expected LSA key
      Failure/Error: decrypted_data << aes.update(policy_secret[i,16])
      
      OpenSSL::Cipher::CipherError:
        key not set
      # ./lib/msf/core/post/windows/priv.rb:368:in `update'
      # ./lib/msf/core/post/windows/priv.rb:368:in `block in decrypt_lsa_data'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/core_ext/range/each.rb:14:in `step'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/core_ext/range/each.rb:14:in `step'
      # ./lib/msf/core/post/windows/priv.rb:365:in `decrypt_lsa_data'
      # ./lib/msf/core/post/windows/priv.rb:324:in `capture_lsa_key'
      # ./spec/lib/msf/core/post/windows/priv_spec.rb:148:in `block (4 levels) in <top (required)>'

  45) Msf::Post::Windows::Priv#decrypt_lsa_data should produce expected plaintext
      Failure/Error: decrypted_data << aes.update(policy_secret[i,16])
      
      OpenSSL::Cipher::CipherError:
        key not set
      # ./lib/msf/core/post/windows/priv.rb:368:in `update'
      # ./lib/msf/core/post/windows/priv.rb:368:in `block in decrypt_lsa_data'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/core_ext/range/each.rb:14:in `step'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/core_ext/range/each.rb:14:in `step'
      # ./lib/msf/core/post/windows/priv.rb:365:in `decrypt_lsa_data'
      # ./spec/lib/msf/core/post/windows/priv_spec.rb:52:in `block (3 levels) in <top (required)>'
Msf::Exploit::Remote::HTTP::Typo3 .........
Metasploit::Framework::Database ............................
Metasploit::Framework::Obfuscation::CRandomizer::Modifier ..
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::Switch .....
Msf::Auxiliary::Cisco FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

  46) Msf::Auxiliary::Cisco#cisco_ios_config_eater password 0
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  47) Msf::Auxiliary::Cisco#cisco_ios_config_eater enable password
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  48) Msf::Auxiliary::Cisco#cisco_ios_config_eater password 7
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  49) Msf::Auxiliary::Cisco#cisco_ios_config_eater password|secret 5
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  50) Msf::Auxiliary::Cisco#cisco_ios_config_eater tunnel key
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  51) Msf::Auxiliary::Cisco#cisco_ios_config_eater crypto isakmp key
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  52) Msf::Auxiliary::Cisco#cisco_ios_config_eater deals with udp ports
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  53) Msf::Auxiliary::Cisco#cisco_ios_config_eater password
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  54) Msf::Auxiliary::Cisco#cisco_ios_config_eater interface tunnel
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  55) Msf::Auxiliary::Cisco#cisco_ios_config_eater encryption key
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  56) Msf::Auxiliary::Cisco#cisco_ios_config_eater ip nhrp authentication
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  57) Msf::Auxiliary::Cisco#cisco_ios_config_eater username secret with password type 0
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  58) Msf::Auxiliary::Cisco#cisco_ios_config_eater username secret with password type 5
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  59) Msf::Auxiliary::Cisco#cisco_ios_config_eater username secret with password type 7
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  60) Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp.*username secret with password type 7
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  61) Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp.*username secret with password type 0
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  62) Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp.*username secret with password type 5
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  63) Msf::Auxiliary::Cisco#cisco_ios_config_eater username privilege secret with password type 7
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  64) Msf::Auxiliary::Cisco#cisco_ios_config_eater username privilege secret with password type 5
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  65) Msf::Auxiliary::Cisco#cisco_ios_config_eater username privilege secret with password type 0
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  66) Msf::Auxiliary::Cisco#cisco_ios_config_eater Enable Password|Secret with password type 5
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  67) Msf::Auxiliary::Cisco#cisco_ios_config_eater Enable Password|Secret with password type 0
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  68) Msf::Auxiliary::Cisco#cisco_ios_config_eater Enable Password|Secret with password type 7
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  69) Msf::Auxiliary::Cisco#cisco_ios_config_eater wpa-psk with password type 7
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  70) Msf::Auxiliary::Cisco#cisco_ios_config_eater wpa-psk with password type 0
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  71) Msf::Auxiliary::Cisco#cisco_ios_config_eater wpa-psk with password type 5
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  72) Msf::Auxiliary::Cisco#cisco_ios_config_eater snmp-server community with RO
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  73) Msf::Auxiliary::Cisco#cisco_ios_config_eater snmp-server community with RW
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  74) Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp chap secret with password type 0
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  75) Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp chap secret with password type 5
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  76) Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp chap secret with password type 7
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:34:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  77) Msf::Auxiliary::Cisco#create_credential_and_login creates a Metasploit::Credential::Login
      Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:46:in `block (3 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  78) Msf::Auxiliary::Cisco#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
      Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/cisco_spec.rb:46:in `block (3 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Msf::Exploit::SQLi::MySQLi::TimeBasedBlind .
Msf::Util::JavaDeserialization ../Users/adfoster/Documents/code/metasploit-framework/spec/lib/msf/util/java_deserialization_spec.rb:16: warning: already initialized constant Msf::Util::JavaDeserialization::PAYLOAD_FILENAME
/Users/adfoster/Documents/code/metasploit-framework/lib/msf/util/java_deserialization.rb:10: warning: previous definition of PAYLOAD_FILENAME was here
/Users/adfoster/Documents/code/metasploit-framework/spec/lib/msf/util/java_deserialization_spec.rb:18: warning: already initialized constant Msf::Util::JavaDeserialization::PAYLOAD_FILENAME
/Users/adfoster/Documents/code/metasploit-framework/spec/lib/msf/util/java_deserialization_spec.rb:16: warning: previous definition of PAYLOAD_FILENAME was here
.......
Metasploit::Framework::LoginScanner::SMB ..........................................................
VirusTotalUtility .../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
...
Rex::Proto::Http::Packet ....
Rex::Proto::Kerberos::CredentialCache::Principal .
hashes/identify ...........................................
Msf::Auxiliary::VYOS FFFFFFFFFFFFFFFFFFFF

  79) Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.3 user passwords
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  80) Msf::Auxiliary::VYOS#vyos_config_eater deals with static ethernet addresses
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  81) Msf::Auxiliary::VYOS#vyos_config_eater deals with static ethernet addresses with description
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  82) Msf::Auxiliary::VYOS#vyos_config_eater deals with wireless client
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  83) Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.1.8 user passwords
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  84) Msf::Auxiliary::VYOS#vyos_config_eater deals with file not found
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  85) Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.3 admin password
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  86) Msf::Auxiliary::VYOS#vyos_config_eater deals with SNMP ro communities
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  87) Msf::Auxiliary::VYOS#vyos_config_eater deals with admin password with no plaintext field
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  88) Msf::Auxiliary::VYOS#vyos_config_eater deals with OS Versions old style
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  89) Msf::Auxiliary::VYOS#vyos_config_eater deals with permission denied
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  90) Msf::Auxiliary::VYOS#vyos_config_eater deals with SNMP rw communities
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  91) Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.1.8 admin password
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  92) Msf::Auxiliary::VYOS#vyos_config_eater deals with wireless server with radius
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  93) Msf::Auxiliary::VYOS#vyos_config_eater deals with OS Versions new style
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  94) Msf::Auxiliary::VYOS#vyos_config_eater deals with wireless server
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  95) Msf::Auxiliary::VYOS#vyos_config_eater deals with masked passwords
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  96) Msf::Auxiliary::VYOS#vyos_config_eater deals with host names
      Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:47:in `block (2 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  97) Msf::Auxiliary::VYOS#create_credential_and_login creates a Metasploit::Credential::Login
      Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:58:in `block (3 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  98) Msf::Auxiliary::VYOS#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
      Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
      
      KeyError:
        Factory not registered: "mdm_workspace"
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
      # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
      # ./spec/lib/msf/core/auxiliary/vyos_spec.rb:58:in `block (3 levels) in <top (required)>'
      # ------------------
      # --- Caused by: ---
      # KeyError:
      #   key not found: "mdm_workspace"
      #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Rex::Proto::Kademlia *.
Rex::Proto::Kerberos::Model::PreAuthEncTimeStamp ......
Metasploit::Framework::LoginScanner::Glassfish ..............................................................
Msf::RPC::RPC_Core ..
RuboCop::Cop::Lint::ModuleDisclosureDatePresent ...
Metasploit::Framework::LoginScanner::Jenkins ..................................................
Rex::Proto::Kademlia::Pong .....
Msf::Ui::Console::TablePrint::HighlightSubstringStyler ...
Msf::Exploit::Remote::SMB::Server::Share ..
Msf::Exploit::Remote::AutoCheck ...............................
Rex::Parser::Ini ..
Msftidy /Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/payloads/payload_tidy.rb - [INFO] No CVE references found. Please check before you land!
./Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb - [INFO] No CVE references found. Please check before you land!
...
Metasploit::Framework::Obfuscation::CRandomizer::RandomStatements ........
Msf::Exploit::Remote::HttpClient .............................
Msf::Exploit::Remote::SMB::Client::LocalPaths ....
Rex::ImageSource::Disk ...................
RuboCop::Cop::Layout::ModuleHashOnNewLine .......
Rex::Crypto ..
Msf::Exploit::Remote::Kerberos::Client::Pac ...............
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::GetTickCount .......
Metasploit::Framework::LoginScanner::POP3 ........................................................
Rex::Proto::Kerberos::Model::KdcRequestBody ........................
Metasploit::Framework::LoginScanner::Zabbix ..................................................
Rex::Proto::Kerberos::Model::PrincipalName ........
Msf::Exploit::Remote::HTTP::JBoss::BeanShell ..........
Msf::Exploit::Remote::HTTP::Wordpress::Login .......
Msf::Post::Linux::BusyBox ..........
Rex::Proto::Rmi::Model::ProtocolAck ......
RuboCop::Cop::Layout::ModuleDescriptionIndentation ........
Rex::Proto::Rmi::Model::DgcAck ....
Rex::Proto::Kerberos::Model::KdcRequest ................
Msf::DBManager ........................FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.......FF.F.FF.F.F.FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.FFFFFFFFFFFFFFF....FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.......................................................................................................FFFFFFFFFF....F.......FFFF....F....FFFFFFFFFFFFFFFFFFFFFF..........FFFF.............................................FF.FFFFFFFF.................................

  99) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session without :host should raise ArgumentError
      Failure/Error:
        expect {
          report_session
        }.to raise_error(ArgumentError)
      
        expected ArgumentError, got #<NameError: uninitialized constant ApplicationRecord> with backtrace:
          # ./lib/msf/core/db_manager/session.rb:109:in `report_session'
          # ./spec/support/shared/examples/msf/db_manager/session.rb:14:in `block (3 levels) in <top (required)>'
          # ./spec/support/shared/examples/msf/db_manager/session.rb:962:in `block (7 levels) in <top (required)>'
          # ./spec/support/shared/examples/msf/db_manager/session.rb:961:in `block (6 levels) in <top (required)>'
      Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
      # ./spec/support/shared/examples/msf/db_manager/session.rb:961:in `block (6 levels) in <top (required)>'

  100) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host without Mdm::Host should raise ArgumentError
       Failure/Error:
         expect {
           report_session
         }.to raise_error(ArgumentError, "Invalid :host, expected Host object")
       
         expected ArgumentError with "Invalid :host, expected Host object", got #<NameError: uninitialized constant ApplicationRecord> with backtrace:
           # ./lib/msf/core/db_manager/session.rb:109:in `report_session'
           # ./spec/support/shared/examples/msf/db_manager/session.rb:14:in `block (3 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/session.rb:953:in `block (8 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/session.rb:952:in `block (7 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # ./spec/support/shared/examples/msf/db_manager/session.rb:952:in `block (7 levels) in <top (required)>'

  101) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  102) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  103) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  104) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  105) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  106) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  107) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  108) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session with :last_seen 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  109) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :closed_at 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  110) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :routes 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  111) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :last_seen without :closed_at 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  112) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :last_seen with :closed_at 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  113) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session with :routes 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  114) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session with :closed_at 
       Failure/Error: FactoryBot.create(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:825:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:820:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  115) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session without Msf::Session should raise ArgumentError
       Failure/Error:
         expect {
           report_session
         }.to raise_error(ArgumentError, "Invalid :session, expected Msf::Session")
       
         expected ArgumentError with "Invalid :session, expected Msf::Session", got #<NameError: uninitialized constant ApplicationRecord> with backtrace:
           # ./lib/msf/core/db_manager/session.rb:109:in `report_session'
           # ./spec/support/shared/examples/msf/db_manager/session.rb:14:in `block (3 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/session.rb:811:in `block (7 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/session.rb:810:in `block (6 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # ./spec/support/shared/examples/msf/db_manager/session.rb:810:in `block (6 levels) in <top (required)>'

  116) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with :workspace should not find workspace from session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  117) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session should set session.db_record to created Mdm::Session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  118) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  119) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session should create an Mdm::Session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  120) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit should create Mdm::Vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  121) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  122) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  123) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  124) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  125) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  126) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without RPORT 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  127) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with RPORT 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  128) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  129) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  130) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  131) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  132) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  133) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  134) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  135) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt with session.via_exploit 'exploit/multi/handler' with session.datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  136) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session responds to arch should pass :arch to #find_or_create_host
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  137) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  138) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.sid present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  139) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  140) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  141) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  142) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_exploit present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  143) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  144) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  145) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  146) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  147) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_payload present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  148) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.platform present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  149) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  150) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.info present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  151) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  152) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.type present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  153) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' should not have session.via_exploit of 'exploit/multi/handler'
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  154) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  155) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' should have session.via_exploit of 'exploit/multi/handler'
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  156) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] should have session.exploit_datastore['ParentModule']
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  157) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  158) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session without session responds to arch should not pass :arch to #find_or_create_host
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  159) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data without :workspace should find workspace from session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  160) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data without :workspace should pass session.workspace to #find_or_create_host
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:139:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:144:in `block (7 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:48:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:74:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  161) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data without :workspace should pass session.workspace to #find_or_create_host
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  162) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data without :workspace should find workspace from session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  163) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with :workspace should not find workspace from session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  164) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  165) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session should create an Mdm::Session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  166) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session should set session.db_record to created Mdm::Session
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  167) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit should create Mdm::Vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  168) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  169) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  170) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  171) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  172) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  173) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without RPORT 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  174) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with RPORT 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  175) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  176) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  177) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  178) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  179) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  180) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  181) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  182) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt with session.via_exploit 'exploit/multi/handler' with session.datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  183) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  184) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  185) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  186) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  187) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_exploit present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  188) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.platform present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  189) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.info present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  190) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  191) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.sid present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  192) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  193) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.type present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  194) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  195) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  196) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  197) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_payload present
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  198) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  199) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' should not have session.via_exploit of 'exploit/multi/handler'
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  200) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  201) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' should have session.via_exploit of 'exploit/multi/handler'
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  202) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  203) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] should have session.exploit_datastore['ParentModule']
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  204) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session responds to arch should pass :arch to #find_or_create_host
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  205) Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session without session responds to arch should not pass :arch to #find_or_create_host
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:102:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:40:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:78:in `block (7 levels) in <top (required)>'
       # <internal:kernel>:90:in `tap'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:73:in `block (6 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/session.rb:24:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  206) Msf::DBManager it should behave like Msf::DBManager::Session #report_session without active should not create a connection
       Failure/Error: expect(ApplicationRecord.connection_pool).not_to receive(:with_connection)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Session" called from ./spec/lib/msf/db_manager_spec.rb:40
       # ./spec/support/shared/examples/msf/db_manager/session.rb:977:in `block (4 levels) in <top (required)>'

  207) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated should call module_to_details_hash to get Mdm::Module::Detail attributes and association attributes
       Failure/Error:
             ApplicationRecord.connection_pool.with_connection do
               info = module_to_details_hash(module_instance)
               bits = info.delete(:bits) || []
               module_detail = Mdm::Module::Detail.create!(info)
         
               bits.each do |args|
                 otype, vals = args
         
                 case otype
                   when :action
       
       NameError:
         uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./lib/msf/core/db_manager/module_cache.rb:334:in `update_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:709:in `update_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:778:in `block (4 levels) in <top (required)>'

  208) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated should create an Mdm::Module::Detail
       Failure/Error:
         expect {
           update_module_details
         }.to change(Mdm::Module::Detail, :count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/module/detail.rb:3:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:784:in `block (4 levels) in <top (required)>'

  209) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "exploit" should not raise error
       Failure/Error:
         expect {
           update_module_details
         }.to_not raise_error
       
         expected no Exception, got #<NameError: uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord> with backtrace:
           # ./lib/msf/core/db_manager/module_cache.rb:334:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:709:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:22:in `block (4 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager#update_module_details with module" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:1091
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'

  210) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "encoder" should not raise error
       Failure/Error:
         expect {
           update_module_details
         }.to_not raise_error
       
         expected no Exception, got #<NameError: uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord> with backtrace:
           # ./lib/msf/core/db_manager/module_cache.rb:334:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:709:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:22:in `block (4 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager#update_module_details with module" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:1087
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'

  211) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "auxiliary" should not raise error
       Failure/Error:
         expect {
           update_module_details
         }.to_not raise_error
       
         expected no Exception, got #<NameError: uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord> with backtrace:
           # ./lib/msf/core/db_manager/module_cache.rb:334:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:709:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:22:in `block (4 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager#update_module_details with module" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:1083
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'

  212) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "post" should not raise error
       Failure/Error:
         expect {
           update_module_details
         }.to_not raise_error
       
         expected no Exception, got #<NameError: uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord> with backtrace:
           # ./lib/msf/core/db_manager/module_cache.rb:334:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:709:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:22:in `block (4 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager#update_module_details with module" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:1101
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'

  213) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "nop" should not raise error
       Failure/Error:
         expect {
           update_module_details
         }.to_not raise_error
       
         expected no Exception, got #<NameError: uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord> with backtrace:
           # ./lib/msf/core/db_manager/module_cache.rb:334:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:709:in `update_module_details'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:22:in `block (4 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager#update_module_details with module" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:1095
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./spec/support/shared/examples/msf/db_manager/update_module_details_with_module_type.rb:21:in `block (3 levels) in <top (required)>'

  214) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :ref should create an Mdm::Module::Ref
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  215) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :ref Mdm::Module::Ref 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  216) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :author should create an Mdm::Module::Author
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  217) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :author Mdm::Module::Author 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  218) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :author Mdm::Module::Author 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  219) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :platform should create an Mdm::Module::Platform
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  220) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :platform Mdm::Module::Platform 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  221) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :arch should create an Mdm::Module::Arch
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  222) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :arch Mdm::Module::Arch 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  223) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :action should create an Mdm::Module::Action
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  224) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :action Mdm::Module::Action 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  225) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :target should create an Mdm::Module::Target
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  226) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :target Mdm::Module::Target 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  227) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :target Mdm::Module::Target 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  228) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  229) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  230) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  231) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  232) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  233) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
       Failure/Error: FactoryBot.generate :mdm_module_detail_privileged
       
       KeyError:
         Sequence not registered: "mdm_module_detail_privileged"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:800:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:792:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:817:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_privileged"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  234) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details without migrated should not create an Mdm::Module::Detail
       Failure/Error:
         expect {
           update_module_details
         }.to_not change(Mdm::Module::Detail, :count)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/module/detail.rb:3:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:1110:in `block (4 levels) in <top (required)>'

  235) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #purge_all_module_details without migrated should not destroy Mdm::Module::Details
       Failure/Error:
         FactoryBot.create_list(
             :mdm_module_detail,
             module_detail_count
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:28:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  236) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #purge_all_module_details with migrated with modules_caching should not destroy Mdm::Module::Details
       Failure/Error:
         FactoryBot.create_list(
             :mdm_module_detail,
             module_detail_count
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:28:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  237) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #purge_all_module_details with migrated without modules_caching should destroy all Mdm::Module::Details
       Failure/Error:
         FactoryBot.create_list(
             :mdm_module_detail,
             module_detail_count
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:28:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  238) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #remove_module_details without migrated should not destroy Mdm::Module::Detail
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:99:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  239) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #remove_module_details with migrated with matching Mdm::Module::Detail should destroy Mdm::Module::Detail
       Failure/Error: FactoryBot.create(:mdm_module_detail)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:114:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  240) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #remove_module_details with migrated without matching Mdm::Module::Detail should not destroy Mdm::Module::Detail
       Failure/Error: FactoryBot.create(:mdm_module_detail)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:114:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  241) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with os keyword with Mdm::Module::Platform#name should find matching Mdm::Module::Platform#name
       Failure/Error: FactoryBot.create(:mdm_module_platform)
       
       KeyError:
         Factory not registered: "mdm_module_platform"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:263
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_platform_name_or_mdm_module_target_name_keyword.rb:8:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_platform"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  242) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with os keyword with Mdm::Module::Target#name should find matching Mdm::Module::Target#name
       Failure/Error: FactoryBot.create(:mdm_module_platform)
       
       KeyError:
         Factory not registered: "mdm_module_platform"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:263
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_platform_name_or_mdm_module_target_name_keyword.rb:8:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_platform"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  243) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with ref keyword with Mdm::Module::Ref#name should match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.create(:mdm_module_ref)
       
       KeyError:
         Factory not registered: "mdm_module_ref"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:278:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  244) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with ref keyword without Mdm::Module::Ref#name should not match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.create(:mdm_module_ref)
       
       KeyError:
         Factory not registered: "mdm_module_ref"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:278:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  245) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with author keyword with Mdm::Module::Author#email should match Mdm::Module::Author#email
       Failure/Error: FactoryBot.create_list(:mdm_module_author, 2)
       
       KeyError:
         Factory not registered: "mdm_module_author"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:167:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_author"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  246) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with author keyword with Mdm::Module::Author#name should match Mdm::Module::Author#name
       Failure/Error: FactoryBot.create_list(:mdm_module_author, 2)
       
       KeyError:
         Factory not registered: "mdm_module_author"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:167:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_author"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  247) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with name keyword with Mdm::Module::Detail#fullname should match Mdm::Module::Detail#fullname
       Failure/Error: FactoryBot.create_list(:mdm_module_detail, 2)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:222:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  248) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with name keyword with Mdm::Module::Detail#name should match Mdm::Module::Detail#name
       Failure/Error: FactoryBot.create_list(:mdm_module_detail, 2)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:222:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  249) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with type keyword with Mdm::Module::Ref#name should match Mdm::Module::Detail#mtype
       Failure/Error: FactoryBot.create_list(:mdm_module_detail, 2)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:320:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  250) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with type keyword without Mdm::Module::Detail#mtype should not match Mdm::Module::Detail#mtype
       Failure/Error: FactoryBot.create_list(:mdm_module_detail, 2)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:320:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  251) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with bid keyword with Mdm::Module::Ref#name starting with "BID-" should match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.create(:mdm_module_ref, :name => name)
       
       KeyError:
         Factory not registered: "mdm_module_ref"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Ref#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:212
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:16:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  252) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with bid keyword without Mdm::Module::Ref#name starting with "BID-" should not match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.generate :mdm_module_ref_name
       
       KeyError:
         Sequence not registered: "mdm_module_ref_name"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Ref#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:212
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:8:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:16:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref_name"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  253) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with cve keyword without Mdm::Module::Ref#name starting with "CVE-" should not match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.generate :mdm_module_ref_name
       
       KeyError:
         Sequence not registered: "mdm_module_ref_name"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Ref#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:213
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:8:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:16:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref_name"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  254) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with cve keyword with Mdm::Module::Ref#name starting with "CVE-" should match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.create(:mdm_module_ref, :name => name)
       
       KeyError:
         Factory not registered: "mdm_module_ref"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Ref#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:213
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:16:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  255) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Ref#name should match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.create(:mdm_module_ref)
       
       KeyError:
         Factory not registered: "mdm_module_ref"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:501:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  256) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Author#name should match Mdm::Module::Author#name
       Failure/Error: FactoryBot.create(:mdm_module_author)
       
       KeyError:
         Factory not registered: "mdm_module_author"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:397:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_author"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  257) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Arch#name should match Mdm::Module::Arch#name
       Failure/Error: FactoryBot.create(:mdm_module_arch)
       
       KeyError:
         Factory not registered: "mdm_module_arch"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:375:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_arch"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  258) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Action#name should match Mdm::Module::Action#name
       Failure/Error: FactoryBot.create(:mdm_module_action)
       
       KeyError:
         Factory not registered: "mdm_module_action"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:353:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_action"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  259) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Platform#name should match Mdm::Module::Platform#name
       Failure/Error: FactoryBot.create(:mdm_module_platform)
       
       KeyError:
         Factory not registered: "mdm_module_platform"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:479:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_platform"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  260) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Detail with #description should match Mdm::Module::Detail#description
       Failure/Error: FactoryBot.create_list(:mdm_module_detail, 3)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:419:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  261) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Detail with #name should match Mdm::Module::Detail#name
       Failure/Error: FactoryBot.create_list(:mdm_module_detail, 3)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:419:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  262) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Detail with #fullname should match Mdm::Module::Detail#fullname
       Failure/Error: FactoryBot.create_list(:mdm_module_detail, 3)
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:42:in `block (2 levels) in define_list_strategy_method'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `initialize'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `new'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:40:in `block in define_list_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:419:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  263) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Target#name should match Mdm::Module::Target#name
       Failure/Error: FactoryBot.create(:mdm_module_target)
       
       KeyError:
         Factory not registered: "mdm_module_target"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:523:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_target"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  264) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with edb keyword without Mdm::Module::Ref#name starting with "EDB-" should not match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.generate :mdm_module_ref_name
       
       KeyError:
         Sequence not registered: "mdm_module_ref_name"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Ref#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:214
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:8:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:16:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref_name"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  265) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with edb keyword with Mdm::Module::Ref#name starting with "EDB-" should match Mdm::Module::Ref#name
       Failure/Error: FactoryBot.create(:mdm_module_ref, :name => name)
       
       KeyError:
         Factory not registered: "mdm_module_ref"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Ref#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:214
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_ref_name_keyword.rb:16:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_ref"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  266) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with platform keyword with Mdm::Module::Platform#name should find matching Mdm::Module::Platform#name
       Failure/Error: FactoryBot.create(:mdm_module_platform)
       
       KeyError:
         Factory not registered: "mdm_module_platform"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:265
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_platform_name_or_mdm_module_target_name_keyword.rb:8:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_platform"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  267) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with platform keyword with Mdm::Module::Target#name should find matching Mdm::Module::Target#name
       Failure/Error: FactoryBot.create(:mdm_module_platform)
       
       KeyError:
         Factory not registered: "mdm_module_platform"
       Shared Example Group: "Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:265
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/search_modules/mdm_module_platform_name_or_mdm_module_target_name_keyword.rb:8:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_platform"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  268) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching should set modules_caching to true and then false
       Failure/Error:
             ApplicationRecord.connection_pool.with_connection do
         
               refresh = []
               skip_reference_name_set_by_module_type = Hash.new { |hash, module_type|
                 hash[module_type] = Set.new
               }
         
               Mdm::Module::Detail.find_each do |md|
         
                 unless md.ready
       
       NameError:
         uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./lib/msf/core/db_manager/module_cache.rb:264:in `update_all_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:543:in `update_all_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:598:in `block (5 levels) in <top (required)>'

  269) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching should set framework.cache_thread to current thread and then nil
       Failure/Error:
             ApplicationRecord.connection_pool.with_connection do
         
               refresh = []
               skip_reference_name_set_by_module_type = Hash.new { |hash, module_type|
                 hash[module_type] = Set.new
               }
         
               Mdm::Module::Detail.find_each do |md|
         
                 unless md.ready
       
       NameError:
         uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./lib/msf/core/db_manager/module_cache.rb:264:in `update_all_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:543:in `update_all_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:584:in `block (5 levels) in <top (required)>'

  270) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching should set modules_cached to false and then true
       Failure/Error:
             ApplicationRecord.connection_pool.with_connection do
         
               refresh = []
               skip_reference_name_set_by_module_type = Hash.new { |hash, module_type|
                 hash[module_type] = Set.new
               }
         
               Mdm::Module::Detail.find_each do |md|
         
                 unless md.ready
       
       NameError:
         uninitialized constant Msf::DBManager::ModuleCache::ApplicationRecord
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # ./lib/msf/core/db_manager/module_cache.rb:264:in `update_all_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:543:in `update_all_module_details'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:591:in `block (5 levels) in <top (required)>'

  271) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh should destroy Mdm::Module::Detail
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:643
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  272) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh without cached module in Msf::ModuleSet should not call update_module_details
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:643
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  273) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should call update_module_details to create a new Mdm::Module::Detail from the module instance returned by create
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:643
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  274) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should create instance of module corresponding to Mdm::Module::Detail
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:643
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  275) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet with exception raised by #update_module_details should log error
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:643
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  276) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh should destroy Mdm::Module::Detail
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:667
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  277) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should call update_module_details to create a new Mdm::Module::Detail from the module instance returned by create
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:667
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  278) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should create instance of module corresponding to Mdm::Module::Detail
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:667
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  279) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet with exception raised by #update_module_details should log error
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:667
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  280) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh without cached module in Msf::ModuleSet should not call update_module_details
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager#update_all_module_details refresh" called from ./spec/support/shared/examples/msf/db_manager/module_cache.rb:667
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  281) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file with same Mdm::Module::Detail#mtime and File.mtime should not update module details
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  282) Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true without existing Mdm::Module::Detail#file should not update module details
       Failure/Error:
         FactoryBot.create(
             :mdm_module_detail,
             :file => module_pathname.to_path,
             :mtime => modification_time,
             :mtype => type,
             :ready => ready,
             :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::DBManager::ModuleCache" called from ./spec/lib/msf/db_manager_spec.rb:34
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/module_cache.rb:627:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  283) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln should not create a match result
       Failure/Error:
         expect {
           report_exploit_failure
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(0)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:118:in `block (5 levels) in <top (required)>'

  284) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln 
       Failure/Error:
         expect {
           report_exploit_failure
         }.not_to change(Mdm::VulnAttempt, :count)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:112:in `block (5 levels) in <top (required)>'

  285) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln calling report_exploit_success should not call create_match_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:52:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:123:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  286) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln calling report_exploit_success should not call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:52:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:123:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  287) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln calling report_exploit_success should not call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:52:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:123:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  288) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln should create a match result with state FAILED
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:52:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:74:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  289) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln should create a match result
       Failure/Error:
         expect {
           report_exploit_failure
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:70:in `block (5 levels) in <top (required)>'

  290) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln 
       Failure/Error:
         expect {
           report_exploit_failure
         }.to change(Mdm::VulnAttempt,:count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:64:in `block (5 levels) in <top (required)>'

  291) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln calling report_exploit_success should not call create_match_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:52:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:86:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  292) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln calling report_exploit_success should call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:52:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:86:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  293) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:52:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:86:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  294) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln should not create a match result
       Failure/Error:
         expect {
           report_exploit_failure
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(0)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:201:in `block (5 levels) in <top (required)>'

  295) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln 
       Failure/Error:
         expect {
           report_exploit_failure
         }.not_to change(Mdm::VulnAttempt, :count)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:195:in `block (5 levels) in <top (required)>'

  296) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln calling report_exploit_success should not call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:149:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:206:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  297) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln calling report_exploit_success should not call create_run_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:149:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:206:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  298) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln calling report_exploit_success should not call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:149:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:206:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  299) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln should not create a match result
       Failure/Error:
         expect {
           report_exploit_failure
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(0)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:166:in `block (5 levels) in <top (required)>'

  300) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln 
       Failure/Error:
         expect {
           report_exploit_failure
         }.to change(Mdm::VulnAttempt,:count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:160:in `block (5 levels) in <top (required)>'

  301) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln calling report_exploit_success should not call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:149:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:171:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  302) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln calling report_exploit_success should not call create_match_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:149:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:171:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  303) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:42:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:149:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:13:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:171:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  304) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln should not create a match result
       Failure/Error:
         expect {
           report_exploit_success
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(0)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:386:in `block (5 levels) in <top (required)>'

  305) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln 
       Failure/Error:
         expect {
           report_exploit_success
         }.to change(Mdm::VulnAttempt,:count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:380:in `block (5 levels) in <top (required)>'

  306) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln calling report_exploit_success should not call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:369:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:391:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  307) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:369:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:391:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  308) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln calling report_exploit_success should not call create_match_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:369:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:391:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  309) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln 
       Failure/Error:
         expect {
           report_exploit_success
         }.not_to change(Mdm::VulnAttempt, :count)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:415:in `block (5 levels) in <top (required)>'

  310) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln should not create a match result
       Failure/Error:
         expect {
           report_exploit_success
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(0)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:421:in `block (5 levels) in <top (required)>'

  311) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln calling report_exploit_success should not call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:369:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:426:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  312) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln calling report_exploit_success should not call create_match_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:369:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:426:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  313) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln calling report_exploit_success should not call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:369:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:426:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  314) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run 
       Failure/Error:
         expect {
           report_exploit_success
         }.not_to change(Mdm::VulnAttempt, :count)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:332:in `block (5 levels) in <top (required)>'

  315) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run should not create a match result
       Failure/Error:
         expect {
           report_exploit_success
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(0)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:338:in `block (5 levels) in <top (required)>'

  316) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run calling report_exploit_success should not call create_match_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:272:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:343:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  317) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run calling report_exploit_success should not call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:272:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:343:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  318) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run calling report_exploit_success should not call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:272:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:343:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  319) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln 
       Failure/Error:
         expect {
           report_exploit_success
         }.to change(Mdm::VulnAttempt,:count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/vuln_attempt.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:285:in `block (5 levels) in <top (required)>'

  320) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln should create a match result
       Failure/Error:
         expect {
           report_exploit_success
         }.to change(MetasploitDataModels::AutomaticExploitation::MatchResult,:count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/metasploit_data_models/automatic_exploitation/match_result.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:291:in `block (5 levels) in <top (required)>'

  321) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln should create a match result with state SUCCEEDED
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:272:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:295:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  322) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln calling report_exploit_success should call create_match_result
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:272:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:306:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  323) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:272:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:306:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  324) Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln calling report_exploit_success should not call create_match_for_vuln
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::ExploitAttempt" called from ./spec/lib/msf/db_manager_spec.rb:25
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:272:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:229:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/exploit_attempt.rb:306:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  325) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :confidence
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:915:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  326) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :description
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:921:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  327) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :name
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:933:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  328) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should be a Hash
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:895:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  329) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :proof
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:945:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  330) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :method
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:927:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  331) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :blame
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:903:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  332) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :pname
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:939:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  333) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :risk
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:951:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  334) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :category
       Failure/Error: FactoryBot.attributes_for(:exported_web_vuln)
       
       KeyError:
         Factory not registered: "exported_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:841:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:863:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:861:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:857:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:846:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:909:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "exported_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  335) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element with required attributes should create an Mdm::WebVuln
       Failure/Error:
         expect {
           import_msf_web_vuln_element
         }.to change(Mdm::WebVuln, :count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/web_vuln.rb:13:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1014:in `block (4 levels) in <top (required)>'

  336) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element call to #import_msf_web_element specialization return should be a Hash
       Failure/Error: FactoryBot.attributes_for(:mdm_web_form, :exported)
       
       KeyError:
         Factory not registered: "mdm_web_form"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:77:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:596:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:594:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:590:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:578:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:609:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_form"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  337) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element call to #import_msf_web_element specialization return should include :params
       Failure/Error: FactoryBot.attributes_for(:mdm_web_form, :exported)
       
       KeyError:
         Factory not registered: "mdm_web_form"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:77:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:596:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:594:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:590:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:578:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:621:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_form"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  338) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element call to #import_msf_web_element specialization return should include :method
       Failure/Error: FactoryBot.attributes_for(:mdm_web_form, :exported)
       
       KeyError:
         Factory not registered: "mdm_web_form"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:77:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:596:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:594:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:590:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:578:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:615:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_form"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  339) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element with required attributes should create an Mdm::WebForm
       Failure/Error:
         expect {
           import_msf_web_form_element
         }.to change(Mdm::WebForm, :count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/web_form.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:663:in `block (4 levels) in <top (required)>'

  340) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element with required attributes should create an Mdm::WebPage
       Failure/Error:
         expect {
           import_msf_web_page_element
         }.to change(Mdm::WebPage, :count).by(1)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/web_page.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:830:in `block (4 levels) in <top (required)>'

  341) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :headers
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:764:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  342) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :ctype
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:758:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  343) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :mtime
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:776:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  344) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should be a Hash
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:730:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  345) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :location
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:770:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  346) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :body
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:740:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  347) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :cookie
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:752:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  348) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :auth
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:734:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  349) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :code
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:692:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:690:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:686:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:675:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:27:in `with_info'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:746:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  350) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type should import all elements in MSF_WEB_TEXT_ELEMENT_NAMES with #import_msf_text_element
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:384:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:380:in `each'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:380:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  351) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type with :workspace should not call Msf::DBManager#workspace
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:278:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:339:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  352) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type with :workspace should pass :workspace to report_web_<:type>
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:278:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:349:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  353) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type notifier with :notifier should call :notifier with event and path
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:278:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:536:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  354) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type notifier without :notifier should not raise an error
       Failure/Error:
         expect {
           import_msf_web_element
         }.to_not raise_error
       
         expected no Exception, got #<KeyError: Factory not registered: "mdm_web_vuln"> with backtrace:
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
           # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:278:in `block (3 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:551:in `block (7 levels) in <top (required)>'
           # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:550:in `block (6 levels) in <top (required)>'
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:550:in `block (6 levels) in <top (required)>'

  355) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type ssl element with element with 'true' text should pass true for :ssl to report_web_<:type>
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/db_manager/workspace.rb:36:in `workspace'
       # ./lib/msf/core/db_manager/import/metasploit_framework/xml.rb:639:in `import_msf_web_element'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:276:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:454:in `block (7 levels) in <top (required)>'

  356) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type ssl element with element without 'true' text should pass false for :ssl to report_web_<:type>
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/db_manager/workspace.rb:36:in `workspace'
       # ./lib/msf/core/db_manager/import/metasploit_framework/xml.rb:639:in `import_msf_web_element'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:276:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:470:in `block (7 levels) in <top (required)>'

  357) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type ssl element without element should pass false for :ssl to report_web_<:type>
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/db_manager/workspace.rb:36:in `workspace'
       # ./lib/msf/core/db_manager/import/metasploit_framework/xml.rb:639:in `import_msf_web_element'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:276:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:429:in `block (6 levels) in <top (required)>'

  358) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type specialization block should pass return Hash to report_web_<:type>
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:278:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:511:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  359) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type specialization block should be called with element and options
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:494:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  360) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type with non-empty Hash from #import_msf_text_element should pass returned Hash as part of Hash passed to report_web_<:type
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:314:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:287:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:286:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:35:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:262:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:278:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:410:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  361) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type without :workspace should call Msf::DBManager#workspace
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:355:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:359:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  362) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type without :workspace should pass Msf::DBManager#workspace to report_web_<:type>
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:355:in `block (5 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:359:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  363) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml should call #check_msf_xml_version!
       Failure/Error: FactoryBot.create(:mdm_workspace)
       
       KeyError:
         Factory not registered: "mdm_workspace"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1021:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1029:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1035:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  364) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml with web_vulns/web_vuln elements should call #import_msf_web_vuln_element
       Failure/Error: FactoryBot.create(:mdm_web_vuln)
       
       KeyError:
         Factory not registered: "mdm_web_vuln"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1164:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1133:in `block (7 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1132:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1131:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1130:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1029:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1170:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_vuln"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  365) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml with web_forms/web_form elements should call #import_msf_web_form_element
       Failure/Error: FactoryBot.attributes_for(:mdm_host)
       
       KeyError:
         Factory not registered: "mdm_host"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:43:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1044:in `block (7 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1042:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1041:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1040:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1029:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1073:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  366) Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml with web_pages/web_page elements should call #import_msf_web_page_element
       Failure/Error: FactoryBot.attributes_for(:mdm_web_page)
       
       KeyError:
         Factory not registered: "mdm_web_page"
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework::XML" called from ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework.rb:6
       Shared Example Group: "Msf::DBManager::Import::MetasploitFramework" called from ./spec/support/shared/examples/msf/db_manager/import.rb:29
       Shared Example Group: "Msf::DBManager::Import" called from ./spec/lib/msf/db_manager_spec.rb:31
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:81:in `block (2 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1083:in `block (7 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1081:in `block (6 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:94:in `method_missing'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1080:in `block (5 levels) in <top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:176:in `_nested_structures'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/builder-3.2.4/lib/builder/xmlbase.rb:69:in `tag!'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1079:in `block (4 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1029:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/db_manager/import/metasploit_framework/xml.rb:1124:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_web_page"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  367) Msf::DBManager it should behave like Msf::DBManager::Migration #reset_column_information should use ApplicationRecord.descendants to find both direct and indirect subclasses
       Failure/Error: expect(ApplicationRecord).to receive(:descendants).and_return([])
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:130:in `block (3 levels) in <top (required)>'

  368) Msf::DBManager it should behave like Msf::DBManager::Migration #reset_column_information should reset column information on each descendant of ApplicationRecord
       Failure/Error: expect(ApplicationRecord).to receive(:descendants).and_return(descendants)
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:142:in `block (3 levels) in <top (required)>'

  369) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate should return an ActiveRecord::MigrationContext with known migrations
       Failure/Error: expect(result.size).to eq 1
       
       NoMethodError:
         undefined method `size' for nil:NilClass
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:38:in `block (3 levels) in <top (required)>'

  370) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate should create an ActiveRecord::MigrationContext
       Failure/Error: expect(ActiveRecord::MigrationContext).to receive(:new)
       
         (ActiveRecord::MigrationContext (class)).new(*(any args))
             expected: 1 time with any arguments
             received: 0 times with any arguments
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:28:in `block (3 levels) in <top (required)>'

  371) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate should reset the column information
       Failure/Error: expect(db_manager).to receive(:reset_column_information)
       
         (#<Msf::DBManager:0x00007fb6906578b0 @framework=#<Framework (0 sessions, 0 jobs, 0 plugins,  database active)>, @migrated=true, @modules_cached=false, @modules_caching=false, @usable=true, @error=#<NameError: uninitialized constant Msf::DBManager::Connection::ApplicationRecord>>).reset_column_information(*(any args))
             expected: 1 time with any arguments
             received: 0 times with any arguments
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:43:in `block (3 levels) in <top (required)>'

  372) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate without verbose should set ActiveRecord::Migration.verbose to false
       Failure/Error: expect(ActiveRecord::Migration).to receive(:verbose=).with(false)
       
         (ActiveRecord::Migration (class)).verbose=(false)
             expected: 1 time with arguments: (false)
             received: 0 times
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:112:in `block (4 levels) in <top (required)>'

  373) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with verbose true should set ActiveRecord::Migration.verbose to true
       Failure/Error: expect(ActiveRecord::Migration).to receive(:verbose=).with(verbose)
       
         (ActiveRecord::Migration (class)).verbose=(true)
             expected: 1 time with arguments: (true)
             received: 0 times
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:103:in `block (5 levels) in <top (required)>'

  374) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with verbose false should set ActiveRecord::Migration.verbose to false
       Failure/Error: expect(ActiveRecord::Migration).to receive(:verbose=).with(verbose)
       
         (ActiveRecord::Migration (class)).verbose=(false)
             expected: 1 time with arguments: (false)
             received: 0 times
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:91:in `block (5 levels) in <top (required)>'

  375) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with StandardError from ActiveRecord::MigrationContext.migrate should log error message at error level
       Failure/Error:
         expect(db_manager).to receive(:elog) do |error_message, error:|
           expect(error_message).to include(standard_error.to_s)
           expect(error).to eql(standard_error)
         end
       
         (#<Msf::DBManager:0x00007fb699a077b8 @framework=#<Framework (0 sessions, 0 jobs, 0 plugins,  database active)>, @migrated=true, @modules_cached=false, @modules_caching=false, @usable=true, @error=#<NameError: uninitialized constant Msf::DBManager::Connection::ApplicationRecord>>).elog(*(any args))
             expected: 1 time with any arguments
             received: 0 times with any arguments
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:71:in `block (4 levels) in <top (required)>'

  376) Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with StandardError from ActiveRecord::MigrationContext.migrate should set Msf::DBManager#error
       Failure/Error: expect(db_manager.error).to eq standard_error
       
         expected: #<StandardError: DB.migrate threw an exception>
              got: #<NameError: uninitialized constant Msf::DBManager::Connection::ApplicationRecord>
       
         (compared using ==)
       
         Diff:
         @@ -1 +1 @@
         -#<StandardError: DB.migrate threw an exception>
         +#<NameError: uninitialized constant Msf::DBManager::Connection::ApplicationRecord>
         
       Shared Example Group: "Msf::DBManager::Migration" called from ./spec/lib/msf/db_manager_spec.rb:33
       # ./spec/support/shared/examples/msf/db_manager/migration.rb:67:in `block (4 levels) in <top (required)>'
Rex::Proto::Kademlia::BootstrapResponse .F.

  377) Rex::Proto::Kademlia::BootstrapResponse#from_data properly decodes real valid bootstrap responses
       Failure/Error: expect(response.peer_id).to eq('B54A83462529B21EF51FD54B956B07B0')
       
       NoMethodError:
         undefined method `peer_id' for nil:NilClass
       # ./spec/lib/rex/proto/kademlia/bootstrap_response_spec.rb:11:in `block (3 levels) in <top (required)>'
Metasploit::Framework::LoginScanner::GitLab ..................................................
Rex::Parser::Unattend ....
Msf::Exploit::Remote::SMB::Server::Share ................................
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::Base .....
Rex::Parser::BITLOCKER .
Msf::Module::SiteReference .
Rex::Proto::Mms::Model::Message .......
Rex::Proto::NATPMP ...
Rex::Oui ......................
Metasploit::Framework::LoginScanner::BavisionCameras ................................................
Msf::Exploit::Remote::HttpServer ........
Msf::Exploit::Remote::HTTP::JBoss::BeanShellScripts ............
Msf::Exploit::Remote::Java::Rmi::Client::Jmx::Connection ...
Msf::Exploit::AutoTarget /Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
FF/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
./Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
FF/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
./Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
./Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:16: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:18: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_untidy.rb:19: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:10: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:11: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
/Users/adfoster/Documents/code/metasploit-framework/spec/file_fixtures/modules/auxiliary/auxiliary_tidy.rb:12: warning: One-line pattern matching is experimental, and the behavior may change in future versions of Ruby!
F

  378) Msf::Exploit::AutoTarget finding the target host should return nil if there is not one
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:85:in `block (3 levels) in <top (required)>'

  379) Msf::Exploit::AutoTarget finding the target host should return a matching Mdm::host if there is one
       Failure/Error: host_obj  = FactoryBot.create(:mdm_host, address: host_addr )
       
       KeyError:
         Factory not registered: "mdm_host"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:78:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  380) Msf::Exploit::AutoTarget#auto_target? should return false if the automatic target is not selected
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:65:in `block (3 levels) in <top (required)>'

  381) Msf::Exploit::AutoTarget#auto_target? should return true if the automatic target is selected
       Failure/Error: host_obj  = FactoryBot.create(:mdm_host, address: host_addr )
       
       KeyError:
         Factory not registered: "mdm_host"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:57:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_host"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  382) Msf::Exploit::AutoTarget adding an Automatic target an exploit without an existing Automatic target should have an Automatic target added to the top of the list
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:36:in `block (4 levels) in <top (required)>'

  383) Msf::Exploit::AutoTarget filtering targets #filter_by_os should return an array of matching targets
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:147:in `block (4 levels) in <top (required)>'

  384) Msf::Exploit::AutoTarget filtering targets #filter_by_os should fall back to previous filter levels if a more strict filter did not return results
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:151:in `block (4 levels) in <top (required)>'

  385) Msf::Exploit::AutoTarget filtering targets #select_target should return the matching target on a precise match
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:157:in `block (4 levels) in <top (required)>'

  386) Msf::Exploit::AutoTarget filtering targets #select_target should return the first match on a less precise match
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:163:in `block (4 levels) in <top (required)>'

  387) Msf::Exploit::AutoTarget filtering targets by OS Version/Service Pack should return an empty array if there are no matching results
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:136:in `block (4 levels) in <top (required)>'

  388) Msf::Exploit::AutoTarget filtering targets by OS Version/Service Pack should return an array of matching results if they exist
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:132:in `block (4 levels) in <top (required)>'

  389) Msf::Exploit::AutoTarget filtering targets by OS Version/Service Pack should return an empty array if there is no SP
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:140:in `block (4 levels) in <top (required)>'

  390) Msf::Exploit::AutoTarget filtering targets #auto_targeted_index should return the index of the selected target
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:171:in `block (4 levels) in <top (required)>'

  391) Msf::Exploit::AutoTarget filtering targets #auto_targeted_index should return nil if it does not find a match
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:177:in `block (4 levels) in <top (required)>'

  392) Msf::Exploit::AutoTarget filtering targets by OS family should return an empty array if there are no matches
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_linux.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:19:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:106:in `block (4 levels) in <top (required)>'

  393) Msf::Exploit::AutoTarget filtering targets by OS family should return nil if the os is unkown on the host
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:110:in `block (4 levels) in <top (required)>'

  394) Msf::Exploit::AutoTarget filtering targets by OS family should return an array of all matching targets
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:102:in `block (4 levels) in <top (required)>'

  395) Msf::Exploit::AutoTarget filtering targets by OS Name should return an array of matching targets when any exist
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:118:in `block (4 levels) in <top (required)>'

  396) Msf::Exploit::AutoTarget filtering targets by OS Name should return an empty array if there are no matches
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:122:in `block (4 levels) in <top (required)>'

  397) Msf::Exploit::AutoTarget filtering targets by OS Name should return an empty array when there is no OS name
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/core/module.rb:209:in `workspace'
       # ./lib/msf/core/exploit/auto_target.rb:54:in `auto_target_host'
       # ./lib/msf/core/exploit/auto_target.rb:14:in `auto_target?'
       # ./lib/msf/core/exploit.rb:638:in `target'
       # ./lib/msf/core/module/data_store.rb:35:in `import_target_defaults'
       # ./lib/msf/core/exploit.rb:294:in `initialize'
       # ./lib/msf/core/exploit/remote.rb:17:in `initialize'
       # ./lib/msf/core/exploit/remote/tcp.rb:54:in `initialize'
       # ./spec/file_fixtures/modules/exploits/auto_target_windows.rb:7:in `initialize'
       # ./lib/msf/core/module_set.rb:53:in `new'
       # ./lib/msf/core/module_set.rb:53:in `create'
       # ./lib/msf/core/module_manager.rb:74:in `create'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:14:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/exploit/auto_target_spec.rb:126:in `block (4 levels) in <top (required)>'
Metasploit::Framework::PasswordCracker::Wordlist ........................
Msf::Module .................................................................................................
Msf::Opt ............................
Msf::Auxiliary::DRDoS .....
Msf::Handler::ReverseHttp .............
Msf::Exploit::Remote::Java::Rmi::Util .............
Rex::Proto::Proxy::Socks5::Server .
Metasploit::Framework::LoginScanner::PhpMyAdmin ..................................................
Metasploit::Framework::LoginScanner::WinRM ....................................................
Rex::ExtTime .
Rex::Proto::Sms::Model::Message .....
Rex::Proto::Kademlia::Ping ..
Msf::Util::DocumentGenerator::PullRequestFinder .............
Msf::Module::Failure .............
Msf::Module::Platform .
Metasploit::Framework::LoginScanner::CiscoFirepower ..........................................
Msf::DatabaseEvent .......
Msf::OptAddressLocal ......./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
..../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
...
Msf::Util::DocumentGenerator::DocumentNormalizer ...................
Msf::Exploit::Remote::SMB::Server::Share ........................
Msf::Exploit::Remote::SMB::Server::Share ......
Metasploit::Framework::LoginScanner::AdvantechWebAccess ..........................................
Msf::OptBool ............
Msf::Exploit::Remote::Java::Rmi::Client::Jmx::Connection::Builder .........................
Msf::ModuleManager ......FFFFFFF..................FFFF.........

  398) Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache should create cache entry for path
       Failure/Error:
         FactoryBot.create(:mdm_module_detail,
                            :file => path,
                            :mtype => type,
                            :mtime => pathname.mtime,
                            :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::ModuleManager::Cache" called from ./spec/lib/msf/core/module_manager_spec.rb:29
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/module_manager/cache.rb:319:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  399) Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
       Failure/Error:
         FactoryBot.create(:mdm_module_detail,
                            :file => path,
                            :mtype => type,
                            :mtime => pathname.mtime,
                            :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::ModuleManager::Cache" called from ./spec/lib/msf/core/module_manager_spec.rb:29
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/module_manager/cache.rb:319:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  400) Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
       Failure/Error:
         FactoryBot.create(:mdm_module_detail,
                            :file => path,
                            :mtype => type,
                            :mtime => pathname.mtime,
                            :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::ModuleManager::Cache" called from ./spec/lib/msf/core/module_manager_spec.rb:29
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/module_manager/cache.rb:319:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  401) Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
       Failure/Error:
         FactoryBot.create(:mdm_module_detail,
                            :file => path,
                            :mtype => type,
                            :mtime => pathname.mtime,
                            :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::ModuleManager::Cache" called from ./spec/lib/msf/core/module_manager_spec.rb:29
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/module_manager/cache.rb:319:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  402) Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
       Failure/Error:
         FactoryBot.create(:mdm_module_detail,
                            :file => path,
                            :mtype => type,
                            :mtime => pathname.mtime,
                            :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::ModuleManager::Cache" called from ./spec/lib/msf/core/module_manager_spec.rb:29
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/module_manager/cache.rb:319:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  403) Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache typed module set with reference_name should not change reference_name value
       Failure/Error:
         FactoryBot.create(:mdm_module_detail,
                            :file => path,
                            :mtype => type,
                            :mtime => pathname.mtime,
                            :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::ModuleManager::Cache" called from ./spec/lib/msf/core/module_manager_spec.rb:29
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/module_manager/cache.rb:319:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  404) Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache typed module set without reference_name should set reference_name value to Msf::SymbolicModule
       Failure/Error:
         FactoryBot.create(:mdm_module_detail,
                            :file => path,
                            :mtype => type,
                            :mtime => pathname.mtime,
                            :refname => reference_name
         )
       
       KeyError:
         Factory not registered: "mdm_module_detail"
       Shared Example Group: "Msf::ModuleManager::Cache" called from ./spec/lib/msf/core/module_manager_spec.rb:29
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/support/shared/examples/msf/module_manager/cache.rb:319:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  405) Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should add module to type's module_set
       Failure/Error: type_directory = Mdm::Module::Detail::DIRECTORY_BY_TYPE[type]
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::ModuleManager::Loading" called from ./spec/lib/msf/core/module_manager_spec.rb:30
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/module/detail.rb:3:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:198:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:188:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:219:in `block (3 levels) in <top (required)>'

  406) Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should pass class to #auto_subscribe_module
       Failure/Error: type_directory = Mdm::Module::Detail::DIRECTORY_BY_TYPE[type]
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::ModuleManager::Loading" called from ./spec/lib/msf/core/module_manager_spec.rb:30
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/module/detail.rb:3:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:198:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:188:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:170:in `on_module_load'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:234:in `block (3 levels) in <top (required)>'

  407) Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should fire on_module_load event with class
       Failure/Error: type_directory = Mdm::Module::Detail::DIRECTORY_BY_TYPE[type]
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::ModuleManager::Loading" called from ./spec/lib/msf/core/module_manager_spec.rb:30
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/module/detail.rb:3:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:198:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:188:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:170:in `on_module_load'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:243:in `block (3 levels) in <top (required)>'

  408) Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should call cache_in_memory
       Failure/Error: type_directory = Mdm::Module::Detail::DIRECTORY_BY_TYPE[type]
       
       NameError:
         uninitialized constant ApplicationRecord
       Shared Example Group: "Msf::ModuleManager::Loading" called from ./spec/lib/msf/core/module_manager_spec.rb:30
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/module/detail.rb:3:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:198:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:188:in `block (3 levels) in <top (required)>'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:170:in `on_module_load'
       # ./spec/support/shared/examples/msf/module_manager/loading.rb:228:in `block (3 levels) in <top (required)>'
Rex::Parser::GPP ..Unable to decode: "blah" Exception: wrong final block length
.Unable to decode: "demo" Exception: wrong final block length
......
Rex::Proto::Kerberos::Pac::Type .
Rex::Proto::Rmi::Model::Ping ...
Msf::Post::Android::Priv ..
Msf::OptionContainer .
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::StringAssignments ...
Metasploit::Framework::LoginScanner::WordpressMulticall .............................................
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::If ...........
Metasploit::Framework::Compiler::Utils .
Metasploit::Framework::LoginScanner::SymantecWebGateway ................................................
Rex::Proto::Http::ClientRequest ................................
Metasploit::Framework::LoginScanner::Redis ........
Rex::Proto::Kerberos::Model::PreAuthPacRequest ...
Msf::Modules::Loader::Base ...........................................................................................
Metasploit::Framework::LoginScanner::AFP ........................................................
Metasploit::Framework::LoginScanner::MySQL ....................................................
Msf::Exploit::Remote::Java::Rmi::Builder ............
Metasploit::Framework::LoginScanner::Nessus ................................................
Metasploit::Framework::LoginScanner::Buffalo ..................................................
Rex::Proto::Kerberos::Model::Authenticator .
Rex::Proto::Proxy::Socks5::Packet ../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
..........
Metasploit::Framework::Aws::Client ..........
Msf::Ui::Console::CommandDispatcher::Creds ...FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.FFFFFFFF

  409) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types db2db does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:426:in `block (8 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  410) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types db2db creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "realm:#{r.value}", "realm-type:#{short_name}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:422:in `block (9 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:420:in `block (8 levels) in <top (required)>'

  411) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types sid does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:426:in `block (8 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  412) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types sid creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "realm:#{r.value}", "realm-type:#{short_name}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:422:in `block (9 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:420:in `block (8 levels) in <top (required)>'

  413) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types domain does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:426:in `block (8 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  414) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types domain creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "realm:#{r.value}", "realm-type:#{short_name}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:422:in `block (9 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:420:in `block (8 levels) in <top (required)>'

  415) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types pgdb creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "realm:#{r.value}", "realm-type:#{short_name}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:422:in `block (9 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:420:in `block (8 levels) in <top (required)>'

  416) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types pgdb does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:426:in `block (8 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  417) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types rsync creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "realm:#{r.value}", "realm-type:#{short_name}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:422:in `block (9 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:420:in `block (8 levels) in <top (required)>'

  418) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types rsync does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:426:in `block (8 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  419) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types wildcard does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:426:in `block (8 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  420) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types wildcard creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "realm:#{r.value}", "realm-type:#{short_name}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:422:in `block (9 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:420:in `block (8 levels) in <top (required)>'

  421) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ssh-key does not create a core if it already exists
       Failure/Error: let(:priv) { FactoryBot.create(:metasploit_credential_ssh_key) }
       
       KeyError:
         Factory not registered: "metasploit_credential_ssh_key"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:391:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:394:in `block (7 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_ssh_key"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  422) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ssh-key creates a core if one does not exist
       Failure/Error: let(:priv) { FactoryBot.create(:metasploit_credential_ssh_key) }
       
       KeyError:
         Factory not registered: "metasploit_credential_ssh_key"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:391:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:394:in `block (7 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_ssh_key"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  423) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ntlm creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "ntlm:#{priv.data}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:357:in `block (8 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:355:in `block (7 levels) in <top (required)>'

  424) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ntlm does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:361:in `block (7 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  425) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types hash does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:380:in `block (7 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  426) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types hash creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "hash:#{priv.data}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:376:in `block (8 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:374:in `block (7 levels) in <top (required)>'

  427) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types password does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:342:in `block (7 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  428) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types password creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "password:#{password}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:338:in `block (8 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:336:in `block (7 levels) in <top (required)>'

  429) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username password and realm creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "user:#{username}", "password:#{password}", "realm:#{realm}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:244:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:242:in `block (6 levels) in <top (required)>'

  430) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username password and realm does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:248:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  431) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms password and realm does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:304:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  432) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms password and realm creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "password:#{password}", "realm:#{realm}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:300:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:298:in `block (6 levels) in <top (required)>'

  433) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and realm does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:266:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  434) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and realm creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "user:#{username}", "realm:#{realm}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:262:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:260:in `block (6 levels) in <top (required)>'

  435) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:323:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  436) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "user:#{username}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:319:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:317:in `block (6 levels) in <top (required)>'

  437) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and password creates a core if one does not exist
       Failure/Error:
         expect {
           creds.cmd_creds('add', "user:#{username}", "password:#{password}")
         }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:281:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:279:in `block (6 levels) in <top (required)>'

  438) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and password does not create a core if it already exists
       Failure/Error: origin: FactoryBot.create(:metasploit_credential_origin_import),
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:285:in `block (6 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  439) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a host
       Failure/Error: expect { create_core_with_login }.to change { Mdm::Host.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/host.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:460:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:460:in `block (6 levels) in <top (required)>'

  440) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a service
       Failure/Error: expect { create_core_with_login }.to change { Mdm::Service.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit_data_models-4.1.1/app/models/mdm/service.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:457:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:457:in `block (6 levels) in <top (required)>'

  441) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a core
       Failure/Error: expect { create_core_with_login }.to change { Metasploit::Credential::Core.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/core.rb:6:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:451:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:451:in `block (6 levels) in <top (required)>'

  442) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a login
       Failure/Error: expect { create_core_with_login }.to change { Metasploit::Credential::Login.count }.by 1
       
       NameError:
         uninitialized constant ApplicationRecord
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/metasploit-credential-4.0.3/app/models/metasploit/credential/login.rb:2:in `<top (required)>'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/zeitwerk-2.4.2/lib/zeitwerk/kernel.rb:34:in `require'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:454:in `block (7 levels) in <top (required)>'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:454:in `block (6 levels) in <top (required)>'

  443) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -t with valid types ntlm should show just the ntlm
       Got 0 failures and 2 other errors:

       443.1) Failure/Error: FactoryBot.create(:metasploit_credential_username, username: username)
              
              KeyError:
                Factory not registered: "metasploit_credential_username"
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
              # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:162:in `block (6 levels) in <top (required)>'
              # ------------------
              # --- Caused by: ---
              # KeyError:
              #   key not found: "metasploit_credential_username"
              #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

       443.2) Failure/Error: priv = FactoryBot.create(:metasploit_credential_password, data: password)
              
              KeyError:
                Factory not registered: "metasploit_credential_password"
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
              # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:165:in `block (6 levels) in <top (required)>'
              # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:197:in `block (6 levels) in <top (required)>'
              # ------------------
              # --- Caused by: ---
              # KeyError:
              #   key not found: "metasploit_credential_password"
              #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  444) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -t with valid types password should show just the password
       Got 0 failures and 2 other errors:

       444.1) Failure/Error: FactoryBot.create(:metasploit_credential_username, username: username)
              
              KeyError:
                Factory not registered: "metasploit_credential_username"
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
              # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:162:in `block (6 levels) in <top (required)>'
              # ------------------
              # --- Caused by: ---
              # KeyError:
              #   key not found: "metasploit_credential_username"
              #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

       444.2) Failure/Error: priv = FactoryBot.create(:metasploit_credential_password, data: password)
              
              KeyError:
                Factory not registered: "metasploit_credential_password"
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
              # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
              # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:165:in `block (6 levels) in <top (required)>'
              # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:197:in `block (6 levels) in <top (required)>'
              # ------------------
              # --- Caused by: ---
              # KeyError:
              #   key not found: "metasploit_credential_password"
              #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  445) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is absent due to a nonmatching username should return a blank set
       Failure/Error: let!(:origin) { FactoryBot.create(:metasploit_credential_origin_import) }
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:36:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  446) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is absent due to a nonmatching password should return a blank set
       Failure/Error: let!(:origin) { FactoryBot.create(:metasploit_credential_origin_import) }
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:36:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  447) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present should not match a regular expression
       Failure/Error: let!(:origin) { FactoryBot.create(:metasploit_credential_origin_import) }
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:36:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  448) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present should show a user that matches the given expression
       Failure/Error: let!(:origin) { FactoryBot.create(:metasploit_credential_origin_import) }
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:36:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  449) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present and when the username is blank should show a user that matches the given expression
       Failure/Error: let!(:origin) { FactoryBot.create(:metasploit_credential_origin_import) }
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:36:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  450) Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present and when the password is blank should show a user that matches the given expression
       Failure/Error: let!(:origin) { FactoryBot.create(:metasploit_credential_origin_import) }
       
       KeyError:
         Factory not registered: "metasploit_credential_origin_import"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:36:in `block (5 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "metasploit_credential_origin_import"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Msf::Author ........................
Msf::Sessions::MainframeShell .
Metasploit::Framework::Obfuscation::CRandomizer::Utility .....
Msf::Exe::SegmentInjector ................
Rex::Proto::Sms::Client ...
Msf::Exploit::Remote::Java::Rmi::Client::Registry .....
Metasploit::Framework::LoginScanner::WordpressRPC ..................................................
Rex::Proto::Kerberos::CredentialCache::Cache .
Rex::Parser::WinSCP ............
Jsobfu ..
.
.
.
Msf::Exploit::Remote::SMB::Server::Share ................
Msf::Exploit::Remote::HTTP::Joomla::Version ...
Msf::Exploit::Remote::FirefoxPrivilegeEscalation .....
Msf::Auxiliary::Juniper FFFFFFFFFFFFFFFFFF

  451) Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with admin credentials
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  452) Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with user account with password hash
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  453) Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with ppp configurations
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  454) Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with ike configurations
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  455) Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with snmp-server community with Read permission
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  456) Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with snmp-server community with Read-Write permission
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  457) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with pap
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  458) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with radius
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  459) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with root credentials
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  460) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with unauthorized
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  461) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with super-user
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  462) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with read-only
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  463) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with operator
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  464) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with snmp-server community with Read permissions
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  465) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with snmp-server community with Read-Write permissions and view
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  466) Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with snmp-server community with a space in the community string
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:34:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  467) Msf::Auxiliary::Juniper#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:46:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  468) Msf::Auxiliary::Juniper#create_credential_and_login creates a Metasploit::Credential::Login
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/juniper_spec.rb:46:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Msf::Ui::Console::CommandDispatcher::Core ..............................
Msf::Exploit::Remote::HTTP::JBoss::DeploymentFileRepositoryScripts .....
Rex::Proto::Kerberos::Pac::ClientInfo .
Rex::Post::Meterpreter::Packet ....................
Metasploit::Framework::Obfuscation::CRandomizer::Parser ..
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::Malloc ....
Msf::Exploit::Remote::SMB::Server::Share ......
Rex::Proto::NTP mode message handling ......
Msf::Exploit::Remote::FirefoxAddonGenerator ..
Rex::Proto::Kerberos::Model::ApReq .
Msf::Exploit::Remote::HTTP::Wordpress::Version ............................................
Rex::Post::Meterpreter::ClientCore .....
Msf::OptEnum .....
Msf::Exploit::Remote::Java::Rmi::Client::Registry::Parser ......
Msf::Exploit::Remote::SMB::Client::RemotePaths ....
Msf::Exploit::Remote::Kerberos::Client::AsRequest ..........
Msf::Auxiliary::Ubiquiti FFFFFFFFFFFFFFFFFFFFF

  469) Msf::Auxiliary::Ubiquiti handles firewallgroups prints correctly
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  470) Msf::Auxiliary::Ubiquiti handles snmp v3 disabled
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  471) Msf::Auxiliary::Ubiquiti handles snmp v3 enabled
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  472) Msf::Auxiliary::Ubiquiti handles snmp v2 enabled
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  473) Msf::Auxiliary::Ubiquiti handles snmp v2 disabled
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  474) Msf::Auxiliary::Ubiquiti handles user devices report_host correctly
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  475) Msf::Auxiliary::Ubiquiti deals with admin users
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  476) Msf::Auxiliary::Ubiquiti handles ssh configurations with passwords
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  477) Msf::Auxiliary::Ubiquiti handles ssh configurations with keys
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  478) Msf::Auxiliary::Ubiquiti handles firewall rules printing
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  479) Msf::Auxiliary::Ubiquiti handles wifi with wpa2
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  480) Msf::Auxiliary::Ubiquiti#create_credential_and_login creates a Metasploit::Credential::Login
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:50:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  481) Msf::Auxiliary::Ubiquiti#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:50:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  482) Msf::Auxiliary::Ubiquiti deals with radius configurations with internal configurations
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  483) Msf::Auxiliary::Ubiquiti converts bson to json handles nil
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  484) Msf::Auxiliary::Ubiquiti converts bson to json handles empty string
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  485) Msf::Auxiliary::Ubiquiti converts bson to json correctly with admin and radius
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  486) Msf::Auxiliary::Ubiquiti handles ntp servers that are not default
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  487) Msf::Auxiliary::Ubiquiti handles ntp servers from ubiquiti
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  488) Msf::Auxiliary::Ubiquiti handles mesh handles mesh configurations
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  489) Msf::Auxiliary::Ubiquiti handles devices report_host correctly
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:38:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::IntAssignments ...
Msf::Exploit::Remote::BrowserProfileManager ...
Msf::Exploit::Remote::Java::Rmi::Client::Jmx::Server::Builder .......
JavaDeserializer ......
Msf::Modules::Metadata::Search ............................................................................................................................................................................................****...................................****..................................................
Metasploit::Framework::LoginScanner::ChefWebUI ..................................................
Msf::Exploit::Remote::SMB::Server::Share ....
Rex::Proto::Kademlia::Message .........
Rex::Proto::Kerberos::Model::AuthorizationData ..
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::Printf ....
Rex::Proto::PJL::Client .......................
Msf::Ui::Console::CommandDispatcher::Common ..
Metasploit::Framework::LoginScanner::Axis2 ...................................................
Metasploit::Framework::Compiler::Windows .
Rex::Proto::SIP::Response parsing ......
Rex::Proto::Rmi::Model::Continuation .....
Rex::Proto::ACPP::Message F.........

  490) Rex::Proto::ACPP::Message#to_s encodes properly
       Failure/Error: expect(retrieve_public_bin).to eq(retrieve_public_message.to_s)
       
         expected: "acpp\x00\x00\x00\x01k\a\x0F\xF4\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\...x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
              got: "acpp\u0000\u0000\u0000\u0001k\a\u000F\xF4\u0000\u0000\u0000\u0001\u0000\u0000\u0000\u0000\u0000\u000...000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000"
       
         (compared using ==)
       # ./spec/lib/rex/proto/acpp/message_spec.rb:41:in `block (3 levels) in <top (required)>'
Metasploit::Framework::LoginScanner::Telnet ...............................................................
Msf::Post::Windows::MSSQL .......................................
Msf::Exploit::Powershell ........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
Msf::Exploit::Remote::BrowserAutopwn2 *...............*........................
Msf::Exploit::Remote::Java::Rmi::Client::Jmx::Server .
CPassword ..
Msf::Auxiliary::Mikrotik FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

  491) Msf::Auxiliary::Mikrotik RouterOS deals with PPP tunnel bridging details saves non-disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  492) Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WEP correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  493) Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details handles open wifi correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  494) Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WPA2 correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  495) Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WPA-EAP correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  496) Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WPA correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  497) Msf::Auxiliary::Mikrotik RouterOS deals with SMB user details saves non-disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  498) Msf::Auxiliary::Mikrotik RouterOS deals with SMB user details saves disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  499) Msf::Auxiliary::Mikrotik RouterOS deals with OpenVPN Client details saves non-disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  500) Msf::Auxiliary::Mikrotik RouterOS deals with OpenVPN Client details saves disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  501) Msf::Auxiliary::Mikrotik RouterOS deals with SMTP User details saves non-disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  502) Msf::Auxiliary::Mikrotik SwOS gets blank password
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  503) Msf::Auxiliary::Mikrotik SwOS gets password
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  504) Msf::Auxiliary::Mikrotik SwOS prints interface 24 name only
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  505) Msf::Auxiliary::Mikrotik SwOS gets snmp password
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  506) Msf::Auxiliary::Mikrotik SwOS gets ip address
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  507) Msf::Auxiliary::Mikrotik SwOS gets hostname
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  508) Msf::Auxiliary::Mikrotik RouterOS deals with PPTP Client details saves disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  509) Msf::Auxiliary::Mikrotik RouterOS deals with PPTP Client details saves non-disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  510) Msf::Auxiliary::Mikrotik RouterOS converts settings to hash handles nil
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  511) Msf::Auxiliary::Mikrotik RouterOS converts settings to hash handles empty string
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  512) Msf::Auxiliary::Mikrotik RouterOS converts settings to hash correctly with several values
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  513) Msf::Auxiliary::Mikrotik RouterOS converts export to hash handles nil
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  514) Msf::Auxiliary::Mikrotik RouterOS converts export to hash correctly with several values
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  515) Msf::Auxiliary::Mikrotik RouterOS converts export to hash correctly with several terse values
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  516) Msf::Auxiliary::Mikrotik RouterOS converts export to hash handles empty string
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  517) Msf::Auxiliary::Mikrotik RouterOS deals with L2TP Client details saves disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  518) Msf::Auxiliary::Mikrotik RouterOS deals with L2TP Client details saves non-disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  519) Msf::Auxiliary::Mikrotik RouterOS deals with PPPoE Client details saves non-disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  520) Msf::Auxiliary::Mikrotik RouterOS deals with PPPoE Client details saves disabled correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  521) Msf::Auxiliary::Mikrotik#create_credential_and_login creates a Metasploit::Credential::Login
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:59:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  522) Msf::Auxiliary::Mikrotik#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:59:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  523) Msf::Auxiliary::Mikrotik RouterOS deals with OS details saves OS correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  524) Msf::Auxiliary::Mikrotik RouterOS deals with OS details saves hostname correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  525) Msf::Auxiliary::Mikrotik RouterOS deals with SNMP details saves v3 RO correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  526) Msf::Auxiliary::Mikrotik RouterOS deals with SNMP details saves RW correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  527) Msf::Auxiliary::Mikrotik RouterOS deals with SNMP details saves RO correct
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:48:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Rex::Post::Meterpreter::Tlv ......................
Rex::Proto::Kademlia::BootstrapRequest ..
Rex::Proto::Nuuo::Client .............................................................
Msf::Auxiliary::Brocade FFFFFFFF

  528) Msf::Auxiliary::Brocade#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:49:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  529) Msf::Auxiliary::Brocade#create_credential_and_login creates a Metasploit::Credential::Login
       Failure/Error: let(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:49:in `block (3 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  530) Msf::Auxiliary::Brocade#brocade_config_eater deals with snmp communities
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:37:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  531) Msf::Auxiliary::Brocade#brocade_config_eater deals with snmp communities
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:37:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  532) Msf::Auxiliary::Brocade#brocade_config_eater deals with enable passwords
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:37:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  533) Msf::Auxiliary::Brocade#brocade_config_eater deals with user passwords
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:37:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  534) Msf::Auxiliary::Brocade#brocade_config_eater deals with user hidden passwords
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:37:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  535) Msf::Auxiliary::Brocade#brocade_config_eater deals with enable hidden passwords
       Failure/Error: let!(:workspace) { FactoryBot.create(:mdm_workspace) }
       
       KeyError:
         Factory not registered: "mdm_workspace"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:70:in `factory_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/factory_runner.rb:12:in `run'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/strategy_syntax_method_registrar.rb:28:in `block in define_singular_strategy_method'
       # ./spec/lib/msf/core/auxiliary/brocade_spec.rb:37:in `block (2 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_workspace"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Metasploit's json-rpc ..F..FF

  536) Metasploit's json-rpc Running a check job and verifying results when the check command raises a known msf error returns the error results
       Failure/Error: expect(rpc_response).to include({ 'result' => hash_including({ 'status' => 'errored' }) })
       
         expected {"error" => {"code" => -32000, "data" => {"code" => 404}, "message" => "Application server error: Results not found for module instance xyNzdOOW2QQNCuoSHFsLDAFL"}, "id" => 1, "jsonrpc" => "2.0"} to include {"result" => #<RSpec::Mocks::ArgumentMatchers::HashIncludingMatcher:0x00007fb69c2b6308 @expected={"status" => "errored"}>}
         Diff:
         @@ -1,3 +1,5 @@
         -"result" => hash_including("status"=>"errored"),
         +"error" => {"code"=>-32000, "data"=>{"code"=>404}, "message"=>"Application server error: Results not found for module instance xyNzdOOW2QQNCuoSHFsLDAFL"},
         +"id" => 1,
         +"jsonrpc" => "2.0",
         
       # ./spec/api/json_rpc_spec.rb:64:in `expect_error_status'
       # ./spec/api/json_rpc_spec.rb:153:in `block (5 levels) in <top (required)>'
       # ./spec/api/json_rpc_spec.rb:87:in `wait_for_expect'
       # ./spec/api/json_rpc_spec.rb:149:in `block (4 levels) in <top (required)>'

  537) Metasploit's json-rpc Running a check job and verifying results when the module returns check code safe returns successful job results
       Failure/Error: expect(rpc_response).to include({ 'result' => hash_including({ 'status' => 'completed' }) })
       
         expected {"error" => {"code" => -32000, "data" => {"code" => 404}, "message" => "Application server error: Results not found for module instance fFgcogyKmEoeOGhEWF49KSrm"}, "id" => 1, "jsonrpc" => "2.0"} to include {"result" => #<RSpec::Mocks::ArgumentMatchers::HashIncludingMatcher:0x00007fb695e23e68 @expected={"status" => "completed"}>}
         Diff:
         @@ -1,3 +1,5 @@
         -"result" => hash_including("status"=>"completed"),
         +"error" => {"code"=>-32000, "data"=>{"code"=>404}, "message"=>"Application server error: Results not found for module instance fFgcogyKmEoeOGhEWF49KSrm"},
         +"id" => 1,
         +"jsonrpc" => "2.0",
         
       # ./spec/api/json_rpc_spec.rb:60:in `expect_completed_status'
       # ./spec/api/json_rpc_spec.rb:117:in `block (5 levels) in <top (required)>'
       # ./spec/api/json_rpc_spec.rb:87:in `wait_for_expect'
       # ./spec/api/json_rpc_spec.rb:113:in `block (4 levels) in <top (required)>'

  538) Metasploit's json-rpc Running a check job and verifying results when the check command has an unexpected error returns the error results
       Failure/Error: expect(rpc_response).to include({ 'result' => hash_including({ 'status' => 'errored' }) })
       
         expected {"error" => {"code" => -32000, "data" => {"code" => 404}, "message" => "Application server error: Results not found for module instance atLa65UOm3KYf7UK0QVNgveR"}, "id" => 1, "jsonrpc" => "2.0"} to include {"result" => #<RSpec::Mocks::ArgumentMatchers::HashIncludingMatcher:0x00007fb6871befa0 @expected={"status" => "errored"}>}
         Diff:
         @@ -1,3 +1,5 @@
         -"result" => hash_including("status"=>"errored"),
         +"error" => {"code"=>-32000, "data"=>{"code"=>404}, "message"=>"Application server error: Results not found for module instance atLa65UOm3KYf7UK0QVNgveR"},
         +"id" => 1,
         +"jsonrpc" => "2.0",
         
       # ./spec/api/json_rpc_spec.rb:64:in `expect_error_status'
       # ./spec/api/json_rpc_spec.rb:185:in `block (5 levels) in <top (required)>'
       # ./spec/api/json_rpc_spec.rb:87:in `wait_for_expect'
       # ./spec/api/json_rpc_spec.rb:181:in `block (4 levels) in <top (required)>'
Msf::Exploit::Remote::Kerberos::Client::CacheCredential ....................
Msf::Post::Android::System .
Msf::OptRegexp ......
Rex::Proto::Http::Client ***...**.*...*.....*.....
Rex::Proto::Http::Packet::Header ........
Metasploit::Framework::LoginScanner::MSSQL .........................................................................................
Rex::Proto::Rmi::Model::OutputHeader ......
Metasploit::Framework::LoginScanner::Postgres ............................................
Rex::Proto::Kerberos::Model::EncryptedData ...F....

  539) Rex::Proto::Kerberos::Model::EncryptedData#encode when EncryptedData without kvno encodes Rex::Proto::Kerberos::Model::EncryptedData correctly
       Failure/Error: expect(sample_enc_data.encode).to eq(sample_enc_data)
       
         expected: "0\x82\x02\x90\xA0\x03\x02\x01\x17\xA2\x82\x02\x87\x04\x82\x02\x83\x8A0\x9D|\xA7\xE4\"6\rD\xF5\xD1:\x...x1A\xAC\xF5%3S\x86\xF5%\xEF\x7F\x1D\x1D\x05?\x128J?\x98\x03\xC8\x9F\xF3\x9B\x87\x80\xB2O\xCD==X\xB5"
              got: "0�\u0002��\u0003\u0002\u0001\u0017��\u0002�\u0004�\u0002��0�|��\"6\rD��:\u0000�7nR ���pf���('1�\u001...0�\u0018)�r\u0001\fC\u0002\v�{\u001A��%3S��%�\u007F\u001D\u001D\u0005?\u00128J?�\u0003�������O�==X�"
       
         (compared using ==)
       
         Diff:
         
         @@ -1,9 +1,9 @@
D??:?7nR ???pf???('1?,| |?<??j??A????Y?????VQ???????D????1???7
                                                              ??Q?=?m??? 3??z???????vq8}BM?
         -?????5.`??q?#??????=S?Nr	c??Q??O??????q?
                                                       ??k=?J?>?3?V?6?V
         -??\?B@r???7????2??
D��:�7nR ���pf���('1�,| |�<��j��A����Y�����VQ�������D����1���7
                                                              ��Q�=�m��� 3��z�������vq8}BM�
         +�����5.`��q�#������=S�Nr	c��Q��O������q�
                                                       ��k=�J�>�3�V�6�V
         +��\�B@r���7����2��
          
         -u ?????????g?0
         -8FZXF?4??FN????$??$???uCF?G?????5????:S???????mH????B???V???G????nms?:??8?O}?94???H?d?3<
                                                                                                  ?>B?t>?hg&?F??1wK?W?I???S?X&?w?? ???'rS 	?9?K
         -T?-
             ?e?aT??m?Vb??k#?????6??F??
~e!???0?????g???F?U?                   ???l?X???2?,?'?9`?^

                    c????Z???QVb~dS?w???????9r?D?f???6???.?m??R????3
                                                                    A??oo?+???@2?????!?#????b7q??i
         -??????ToLC??)????K^%?dE>?~?g??9????p??)?r
                                                   C
                                                    ?{??%3S??%??8J?????????O?==X?
         +u ���������g�0
         +8FZXF�4��FN����$��$���uCF�G�����5����:S��������H����B���V���G����nms�:��8�O}�94���H�d�3<
                                                                                                  �>B�t>�hg&�F��1wK�W�I���S�X&���� ���'rS 	�9�K
         +T�-
             �e�aT��m�Vb��k#�����6��F��
~e!���0�����g���F�U�                   ���l�X���2�,�'�9`�^

                    c����Z���QVb~dS�w�������9r�D�f���6���.�m��R����3
                                                                    A��oo�+���@2�����!�#����b7q��i
         +������ToLC��)����K^%�dE>�~�g��9����p��)�r
                                                   C
                                                    �{��%3S��%�?8J?��������O�==X�
         
       # ./spec/lib/rex/proto/kerberos/model/encrypted_data_spec.rb:156:in `block (4 levels) in <top (required)>'
Msf::Sessions::Meterpreter .../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
/Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:231: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
.
Rex::Crypto ......
Rex::Proto::Rmi::Model::ReturnValue .........
Rex::Proto::Http::Response ...................
Rex::Proto::Kerberos::Model::KdcResponse ......
Msf::Exploit::Remote::Kerberos::Client::AsResponse ........
Rex::Proto::Nuuo::Response ...
Rex::Post::Meterpreter::Extensions::Stdapi::Sys::Registry ......
Msf::HostState ...
Rex::Proto::Mms::Model::Smtp .......
Net::DNS::RR::Types .*.....
Msf::OptPath ..........
Msf::OptPort ..........
Rex::Proto::Steam .....
Metasploit::Framework::LoginScanner::SSH ...........................................................
Rex::Payloads::Meterpreter::UriChecksum ......................................................................................................................................
Msf::RPC::RpcJobStatusTracker ......F.F....FFF.F....

  540) Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job fails should show as finished
       Failure/Error: expect(job_status_tracker).to be_finished(job_id)
         expected `#<Msf::RPC::RpcJobStatusTracker:0x00007fb691fd5558 @mon_data=#<Monitor:0x00007fb691fd5468>, @mon_data...t: {}>, @results=<#Msf::RPC::RpcJobStatusTracker::ResultsMemoryStore entries=0, size=0, options={}>>.finished?("super_random_job_id")` to be truthy, got false
       # ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:114:in `block (6 levels) in <top (required)>'

  541) Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job fails should have a retrievable result
       Failure/Error: expect(job_status_tracker.result(job_id)).to eql({ 'error' => bad_result })
       
         expected: {"error"=>"boo_fail"}
              got: nil
       
         (compared using eql?)
       # ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:119:in `block (6 levels) in <top (required)>'

  542) Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job result is not serializable should show as finished
       Failure/Error: expect(job_status_tracker).to be_finished(job_id)
         expected `#<Msf::RPC::RpcJobStatusTracker:0x00007fb69bbf4f38 @mon_data=#<Monitor:0x00007fb69bbf4ec0>, @mon_data...t: {}>, @results=<#Msf::RPC::RpcJobStatusTracker::ResultsMemoryStore entries=0, size=0, options={}>>.finished?("super_random_job_id")` to be truthy, got false
       # ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:156:in `block (6 levels) in <top (required)>'

  543) Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job result is not serializable should have an error result
       Failure/Error:
         expect(job_status_tracker.result(job_id)).to eql(
           {
             'error' => {
               'message' => 'Job finished but the result could not be stored',
               'data' => {
                 'mod' => 'module_name'
               }
             }
           }
         )
       
         expected: {"error"=>{"data"=>{"mod"=>"module_name"}, "message"=>"Job finished but the result could not be stored"}}
              got: nil
       
         (compared using eql?)
       # ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:161:in `block (6 levels) in <top (required)>'

  544) Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job completes successfully should have a retrievable result
       Failure/Error: expect(job_status_tracker.result(job_id)).to eql({ 'result' => good_result })
       
         expected: {"result"=>"yay_success"}
              got: nil
       
         (compared using eql?)
       # ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:73:in `block (6 levels) in <top (required)>'

  545) Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job completes successfully should show as finished
       Failure/Error: expect(job_status_tracker).to be_finished(job_id)
         expected `#<Msf::RPC::RpcJobStatusTracker:0x00007fb695aec0d8 @mon_data=#<Monitor:0x00007fb695aec088>, @mon_data...t: {}>, @results=<#Msf::RPC::RpcJobStatusTracker::ResultsMemoryStore entries=0, size=0, options={}>>.finished?("super_random_job_id")` to be truthy, got false
       # ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:68:in `block (6 levels) in <top (required)>'
Rex::Proto::Kerberos::Model::Ticket ......
Msf::Exploit::Remote::SMB::Server::Share ..
Msf::RPC::JSON::Dispatcher ...................................
Rex::Proto::Kerberos::Model::KrbError ...............
Rex::Proto::Rmi::Model::CallData ..........
Rex::Proto::Mms::Client ...
Metasploit::Framework::LoginScanner::Base ............
Msf::Ui::Console::TablePrint::RankFormatter ..
Msf::DBImportError .
Md5LookupUtility .........................
Msf::Exploit::Remote::BrowserExploitServer .............................
Rex::Proto::Rmi::Model::Call ....
Msf::ModuleSet FFFFFF

  546) Msf::ModuleSet#rank_modules with Msf::SymbolicModule create returns nil 
       Failure/Error: FactoryBot.generate :mdm_module_detail_mtype
       
       KeyError:
         Sequence not registered: "mdm_module_detail_mtype"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/lib/msf/core/module_set_spec.rb:9:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:5:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:19:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_mtype"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  547) Msf::ModuleSet#rank_modules with Msf::SymbolicModule create returns nil is ranked as Manual
       Failure/Error: FactoryBot.generate :mdm_module_detail_mtype
       
       KeyError:
         Sequence not registered: "mdm_module_detail_mtype"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/lib/msf/core/module_set_spec.rb:9:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:5:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:19:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_mtype"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  548) Msf::ModuleSet#rank_modules with Msf::SymbolicModule create does not return nil without Rank is ranked as Normal
       Failure/Error: FactoryBot.generate :mdm_module_detail_mtype
       
       KeyError:
         Sequence not registered: "mdm_module_detail_mtype"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/lib/msf/core/module_set_spec.rb:9:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:5:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:19:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_mtype"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  549) Msf::ModuleSet#rank_modules with Msf::SymbolicModule create does not return nil with Rank is ranked using Rank
       Failure/Error: FactoryBot.generate :mdm_module_detail_mtype
       
       KeyError:
         Sequence not registered: "mdm_module_detail_mtype"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/lib/msf/core/module_set_spec.rb:9:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:5:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:19:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_mtype"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  550) Msf::ModuleSet#rank_modules without Msf::SymbolicModule with Rank is ranked using Rank
       Failure/Error: FactoryBot.generate :mdm_module_detail_mtype
       
       KeyError:
         Sequence not registered: "mdm_module_detail_mtype"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/lib/msf/core/module_set_spec.rb:9:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:5:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:158:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_mtype"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'

  551) Msf::ModuleSet#rank_modules without Msf::SymbolicModule without Rank is ranked as Normal
       Failure/Error: FactoryBot.generate :mdm_module_detail_mtype
       
       KeyError:
         Sequence not registered: "mdm_module_detail_mtype"
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/registry.rb:23:in `find'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/decorator.rb:12:in `method_missing'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/internal.rb:54:in `sequence_by_name'
       # /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/factory_bot-6.1.0/lib/factory_bot/syntax/methods.rb:114:in `generate'
       # ./spec/lib/msf/core/module_set_spec.rb:9:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:5:in `block (2 levels) in <top (required)>'
       # ./spec/lib/msf/core/module_set_spec.rb:158:in `block (4 levels) in <top (required)>'
       # ------------------
       # --- Caused by: ---
       # KeyError:
       #   key not found: "mdm_module_detail_mtype"
       #   /Users/adfoster/.rvm/gems/ruby-3.0.0/gems/activesupport-5.2.4.5/lib/active_support/hash_with_indifferent_access.rb:190:in `fetch'
Msf::Framework *...
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::FakeFunctionCollection ......
Msf::OptAddressRange ........./Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
...../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
....../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
...../Users/adfoster/.rvm/gems/ruby-3.0.0/gems/rex-socket-0.1.25/lib/rex/socket.rb:189: warning: Socket.gethostbyname is deprecated; use Addrinfo.getaddrinfo instead.
....
Msf::Exploit::Capture .*.***......
Rex::Proto::Kerberos::Pac::PrivSvrChecksum .
Msf::Exploit::Remote::SMB::Server::Share ......
Msf::FeatureManager ......................
Rex::Proto::Kerberos::Pac::ServerChecksum .
Metasploit::Framework::LoginScanner::Smh .............................................
Metasploit::Framework::LoginScanner::FTP .............................................................
Metasploit::Framework::Obfuscation::CRandomizer::CodeFactory::UninitVariables ......
Msf::Ui::Console::CommandDispatcher::Db ........................................F...FF.FFFFFFFFFF

  552) Msf::Ui::Console::CommandDispatcher::Db#cmd_notes -h should show a help message
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             mode = :search
             data = nil
             types = nil
             set_rhosts = false
         
             host_ranges = []
             rhosts      = []
             search_term = nil
             output_file = nil
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/ui/console/command_dispatcher/db.rb:981:in `cmd_notes'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:166:in `block (4 levels) in <top (required)>'

  553) Msf::Ui::Console::CommandDispatcher::Db#cmd_db_export -h should show a help message
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
         
             export_formats = %W{xml pwdump}
             format = 'xml'
             output = nil
         
             while (arg = args.shift)
               case arg
               when '-h','--help'
                 print_line "Usage:"
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/ui/console/command_dispatcher/db.rb:1529:in `cmd_db_export'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:56:in `block (4 levels) in <top (required)>'

  554) Msf::Ui::Console::CommandDispatcher::Db#cmd_services -p should list services that are on a given port
       Got 0 failures and 2 other errors:

       554.1) Failure/Error:
                  ::ApplicationRecord.connection_pool.with_connection {
                    # If we have the ID, there is no point in creating a complex query.
                    if opts[:id] && !opts[:id].to_s.empty?
                      return Array.wrap(Mdm::Workspace.find(opts[:id]))
                    end
                
                    opts = opts.clone() # protect the original callers array
                    search_term = opts.delete(:search_term)
                    # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
                    opts.delete(:workspace)
              
              NameError:
                uninitialized constant ApplicationRecord
              # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:194:in `add_opts_workspace'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:37:in `block in report_service'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:36:in `report_service'
              # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:215:in `block (4 levels) in <top (required)>'

       554.2) Failure/Error:
                ::ApplicationRecord.connection_pool.with_connection {
                  deleted = []
                  opts[:ids].each do |service_id|
                    service = Mdm::Service.find(service_id)
                    begin
                      deleted << service.destroy
                    rescue
                      elog("Forcibly deleting #{service.name}")
                      deleted << service.delete
                    end
              
              NameError:
                uninitialized constant ApplicationRecord
              # ./lib/msf/core/db_manager/service.rb:6:in `delete_service'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:58:in `block in delete_service'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:57:in `delete_service'
              # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:226:in `block (4 levels) in <top (required)>'

  555) Msf::Ui::Console::CommandDispatcher::Db#cmd_services -np should list services that are not on a given port
       Got 0 failures and 2 other errors:

       555.1) Failure/Error:
                  ::ApplicationRecord.connection_pool.with_connection {
                    # If we have the ID, there is no point in creating a complex query.
                    if opts[:id] && !opts[:id].to_s.empty?
                      return Array.wrap(Mdm::Workspace.find(opts[:id]))
                    end
                
                    opts = opts.clone() # protect the original callers array
                    search_term = opts.delete(:search_term)
                    # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
                    opts.delete(:workspace)
              
              NameError:
                uninitialized constant ApplicationRecord
              # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
              # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:194:in `add_opts_workspace'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:37:in `block in report_service'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:36:in `report_service'
              # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:246:in `block (4 levels) in <top (required)>'

       555.2) Failure/Error:
                ::ApplicationRecord.connection_pool.with_connection {
                  deleted = []
                  opts[:ids].each do |service_id|
                    service = Mdm::Service.find(service_id)
                    begin
                      deleted << service.destroy
                    rescue
                      elog("Forcibly deleting #{service.name}")
                      deleted << service.delete
                    end
              
              NameError:
                uninitialized constant ApplicationRecord
              # ./lib/msf/core/db_manager/service.rb:6:in `delete_service'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:58:in `block in delete_service'
              # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
              # ./lib/metasploit/framework/data_service/proxy/service_data_proxy.rb:57:in `delete_service'
              # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:257:in `block (4 levels) in <top (required)>'

  556) Msf::Ui::Console::CommandDispatcher::Db#cmd_db_import -h should show a help message
       Failure/Error:
         ::ApplicationRecord.connection_pool.with_connection {
           if args.include?("-h") || ! (args && args.length > 0)
             cmd_db_import_help
             return
           end
           args.each { |glob|
             files = ::Dir.glob(::File.expand_path(glob))
             if files.empty?
               print_error("No such file #{glob}")
               next
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/ui/console/command_dispatcher/db.rb:1444:in `cmd_db_import'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:69:in `block (4 levels) in <top (required)>'

  557) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace <no arguments> should list default workspace
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'

  558) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace <no arguments> should list all workspaces
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'

  559) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -D should delete all workspaces
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'

  560) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -h should show a help message
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'

  561) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -a should add workspaces
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'

  562) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -d should delete a workspace
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'

  563) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -v should list default workspace verbosely
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'

  564) Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -v should list all workspaces verbosely
       Failure/Error:
           ::ApplicationRecord.connection_pool.with_connection {
             # If we have the ID, there is no point in creating a complex query.
             if opts[:id] && !opts[:id].to_s.empty?
               return Array.wrap(Mdm::Workspace.find(opts[:id]))
             end
         
             opts = opts.clone() # protect the original callers array
             search_term = opts.delete(:search_term)
             # Passing these values to the search will cause exceptions, so remove them if they accidentally got passed in.
             opts.delete(:workspace)
       
       NameError:
         uninitialized constant ApplicationRecord
       # ./lib/msf/core/db_manager/workspace.rb:49:in `workspaces'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:7:in `block in find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/core.rb:166:in `data_service_operation'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:5:in `find_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:27:in `default_workspace'
       # ./lib/metasploit/framework/data_service/proxy/workspace_data_proxy.rb:44:in `workspace'
       # ./lib/msf/ui/console/command_dispatcher/db.rb:158:in `cmd_workspace'
       # ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:303:in `block (3 levels) in <top (required)>'
Metasploit::Framework::LoginScanner::Tomcat ..................................................

An error occurred in an `after(:suite)` hook.
Failure/Error:
  raise RuntimeError,
        "#{thread_count} #{'thread'.pluralize(thread_count)} exist(s) when only " \
        "#{EXPECTED_THREAD_COUNT_AROUND_SUITE} " \
        "#{'thread'.pluralize(EXPECTED_THREAD_COUNT_AROUND_SUITE)} expected after suite runs:\n" \
        "#{error_lines.join}"

RuntimeError:
  15 threads exist(s) when only 3 threads expected after suite runs:
# ./lib/metasploit/framework/spec/threads/suite.rb:100:in `block (2 levels) in configure!'

Top 10 slowest examples (186.81 seconds, 45.3% of total time):
  Msf::EncodedPayload#generate with windows/meterpreter_bind_tcp and bad characters: "\x00\x0a\x0d" chooses x86/xor_dynamic
    61.11 seconds ./spec/lib/msf/core/encoded_payload_spec.rb:162
  Msf::EncodedPayload#generate with windows/meterpreter_bind_tcp and bad characters: "\x00\x0a\x0d" is expected not to include "\x00\n\r"
    60.97 seconds ./spec/lib/msf/core/encoded_payload_spec.rb:166
  Metasploit's json-rpc Running a check job and verifying results when the module returns check code safe returns successful job results
    11.67 seconds ./spec/api/json_rpc_spec.rb:107
  Metasploit's json-rpc Running a check job and verifying results when the check command has an unexpected error returns the error results
    11.64 seconds ./spec/api/json_rpc_spec.rb:174
  Metasploit's json-rpc Running a check job and verifying results when the check command raises a known msf error returns the error results
    11.64 seconds ./spec/api/json_rpc_spec.rb:142
  Metasploit::Framework::LoginScanner::VNC#attempt_login creates a new RFB client
    10 seconds ./spec/lib/metasploit/framework/login_scanner/vnc_spec.rb:21
  Rex::Parser::BITLOCKER Extract and decrypt recovery key from recovery password
    9.31 seconds ./spec/lib/rex/parser/fs/bitlocker_spec.rb:88
  Metasploit::Framework::LoginScanner::DB2 behaves like Metasploit::Framework::LoginScanner::Base validations host is not valid for DNS name that cannot be resolved
    4.78 seconds ./spec/support/shared/examples/metasploit/framework/login_scanner/login_scanner_base.rb:158
  Msf::Post::Linux::BusyBox#busy_box_writable_dir when a writable directory doesn't exist returns nil
    3.25 seconds ./spec/lib/msf/core/post/linux/busy_box_spec.rb:89
  Msf::Post::Linux::BusyBox#busy_box_write_file when prepend is true when there is a writable dir when the target file is writable returns true
    2.44 seconds ./spec/lib/msf/core/post/linux/busy_box_spec.rb:164

Top 10 slowest example groups:
  Rex::Parser::BITLOCKER
    9.31 seconds average (9.31 seconds / 1 example) ./spec/lib/rex/parser/fs/bitlocker_spec.rb:82
  Msf::EncodedPayload
    8.73 seconds average (122.21 seconds / 14 examples) ./spec/lib/msf/core/encoded_payload_spec.rb:3
  Metasploit's json-rpc
    5.34 seconds average (37.4 seconds / 7 examples) ./spec/api/json_rpc_spec.rb:10
  Msf::Post::Linux::BusyBox
    0.9771 seconds average (9.77 seconds / 10 examples) ./spec/lib/msf/core/post/linux/busy_box_spec.rb:5
  Msf::Exploit::AutoTarget
    0.21951 seconds average (5.05 seconds / 23 examples) ./spec/lib/msf/core/exploit/auto_target_spec.rb:3
  Metasploit::Framework::Compiler::Windows
    0.20313 seconds average (0.20313 seconds / 1 example) ./spec/lib/metasploit/framework/compiler/windows_spec.rb:4
  Msf::Ui::Console::CommandDispatcher::Creds
    0.19335 seconds average (8.89 seconds / 46 examples) ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:5
  Msf::Ui::Console::CommandDispatcher::Db
    0.18634 seconds average (10.62 seconds / 57 examples) ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:4
  Metasploit::Framework::LoginScanner::VNC
    0.17108 seconds average (10.09 seconds / 59 examples) ./spec/lib/metasploit/framework/login_scanner/vnc_spec.rb:4
  Msf::DBExport
    0.171 seconds average (4.1 seconds / 24 examples) ./spec/lib/msf/db_manager/export_spec.rb:4

Finished in 6 minutes 52 seconds (files took 11.52 seconds to load)
11695 examples, 564 failures, 30 pending, 1 error occurred outside of examples

Failed examples:

rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:237 # Msf::Auxiliary::Arista deals with SNMP details saves RW correct
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:264 # Msf::Auxiliary::Arista deals with SNMP details saves RO correct
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:80 # Msf::Auxiliary::Arista#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:77 # Msf::Auxiliary::Arista#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:131 # Msf::Auxiliary::Arista#arista_eos_config_eater deals with aaa root secret
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:107 # Msf::Auxiliary::Arista#arista_eos_config_eater deals with enable passwords
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:91 # Msf::Auxiliary::Arista#arista_eos_config_eater deals with model and version
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:99 # Msf::Auxiliary::Arista#arista_eos_config_eater deals with hostname
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:184 # Msf::Auxiliary::Arista deals with user details deals with no roles and md5 passwords
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:208 # Msf::Auxiliary::Arista deals with user details deals with no roles and plaintext passwords
rspec ./spec/lib/msf/core/auxiliary/arista_spec.rb:160 # Msf::Auxiliary::Arista deals with user details deals with roles and sha512 passwords
rspec ./spec/lib/msf/debug_spec.rb:1331 # Msf::Ui::Debug correctly retrieves version information with DB connected via local connection
rspec ./spec/lib/msf/core/auxiliary/f5_spec.rb:91 # Msf::Auxiliary::F5#f5_config_eater deals with user passwords
rspec ./spec/lib/msf/core/auxiliary/f5_spec.rb:170 # Msf::Auxiliary::F5#f5_config_eater deals with host information
rspec ./spec/lib/msf/core/auxiliary/f5_spec.rb:126 # Msf::Auxiliary::F5#f5_config_eater deals with system keys
rspec ./spec/lib/msf/core/auxiliary/f5_spec.rb:201 # Msf::Auxiliary::F5#f5_config_eater deals with SSL Keys
rspec ./spec/lib/msf/core/auxiliary/f5_spec.rb:231 # Msf::Auxiliary::F5#f5_config_eater deals with SNMP
rspec ./spec/lib/msf/core/auxiliary/f5_spec.rb:80 # Msf::Auxiliary::F5#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec ./spec/lib/msf/core/auxiliary/f5_spec.rb:77 # Msf::Auxiliary::F5#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/db_manager/export_spec.rb:100 # Msf::DBExport#extract_module_detail_info without Mdm::Module::Details should not write anything to report_file
rspec ./spec/lib/msf/db_manager/export_spec.rb:56 # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details should have module_detail tag for each Mdm::Module::Detail
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:3:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#file for file content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:3:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#file nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:10:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#rank for rank content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:10:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#rank nil
rspec ./spec/lib/msf/db_manager/export_spec.rb:74 # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail /disclosure-date should have Mdm::Module::Detail#disclosure_date present
rspec ./spec/lib/msf/db_manager/export_spec.rb:78 # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail /disclosure-date should have Mdm::Module::Detail#disclosure_date from disclosure-date content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:4:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#fullname for fullname content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:4:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#fullname nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:9:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#privileged nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:9:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#privileged for privileged content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:5:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#license for license content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:5:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#license nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:7:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#mtype for mtype content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:7:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#mtype nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:1:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#description nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:1:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#description for description content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:11:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#refname for refname content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:11:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#refname nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:6:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#mtime for mtime content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:6:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#mtime nil
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:8:2]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should have Mdm::Module::Detail#name for name content
rspec './spec/lib/msf/db_manager/export_spec.rb[1:1:1:2:8:1]' # Msf::DBExport#extract_module_detail_info with Mdm::Module::Details module_detail it should behave like Msf::DBExport#extract_module_detail_info module_detail child should not have Mdm::Module::Detail#name nil
rspec ./spec/lib/msf/core/post/windows/priv_spec.rb:145 # Msf::Post::Windows::Priv#capture_lsa_key with a Vista or newer registry should produce expected LSA key
rspec ./spec/lib/msf/core/post/windows/priv_spec.rb:51 # Msf::Post::Windows::Priv#decrypt_lsa_data should produce expected plaintext
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:290 # Msf::Auxiliary::Cisco#cisco_ios_config_eater password 0
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:177 # Msf::Auxiliary::Cisco#cisco_ios_config_eater enable password
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:246 # Msf::Auxiliary::Cisco#cisco_ios_config_eater password 7
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:266 # Msf::Auxiliary::Cisco#cisco_ios_config_eater password|secret 5
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:451 # Msf::Auxiliary::Cisco#cisco_ios_config_eater tunnel key
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:419 # Msf::Auxiliary::Cisco#cisco_ios_config_eater crypto isakmp key
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:82 # Msf::Auxiliary::Cisco#cisco_ios_config_eater deals with udp ports
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:313 # Msf::Auxiliary::Cisco#cisco_ios_config_eater password
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:442 # Msf::Auxiliary::Cisco#cisco_ios_config_eater interface tunnel
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:336 # Msf::Auxiliary::Cisco#cisco_ios_config_eater encryption key
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:474 # Msf::Auxiliary::Cisco#cisco_ios_config_eater ip nhrp authentication
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:575 # Msf::Auxiliary::Cisco#cisco_ios_config_eater username secret with password type 0
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:599 # Msf::Auxiliary::Cisco#cisco_ios_config_eater username secret with password type 5
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:625 # Msf::Auxiliary::Cisco#cisco_ios_config_eater username secret with password type 7
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:701 # Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp.*username secret with password type 7
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:651 # Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp.*username secret with password type 0
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:675 # Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp.*username secret with password type 5
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:549 # Msf::Auxiliary::Cisco#cisco_ios_config_eater username privilege secret with password type 7
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:523 # Msf::Auxiliary::Cisco#cisco_ios_config_eater username privilege secret with password type 5
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:498 # Msf::Auxiliary::Cisco#cisco_ios_config_eater username privilege secret with password type 0
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:131 # Msf::Auxiliary::Cisco#cisco_ios_config_eater Enable Password|Secret with password type 5
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:107 # Msf::Auxiliary::Cisco#cisco_ios_config_eater Enable Password|Secret with password type 0
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:152 # Msf::Auxiliary::Cisco#cisco_ios_config_eater Enable Password|Secret with password type 7
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:393 # Msf::Auxiliary::Cisco#cisco_ios_config_eater wpa-psk with password type 7
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:346 # Msf::Auxiliary::Cisco#cisco_ios_config_eater wpa-psk with password type 0
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:369 # Msf::Auxiliary::Cisco#cisco_ios_config_eater wpa-psk with password type 5
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:202 # Msf::Auxiliary::Cisco#cisco_ios_config_eater snmp-server community with RO
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:223 # Msf::Auxiliary::Cisco#cisco_ios_config_eater snmp-server community with RW
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:727 # Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp chap secret with password type 0
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:750 # Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp chap secret with password type 5
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:775 # Msf::Auxiliary::Cisco#cisco_ios_config_eater ppp chap secret with password type 7
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:68 # Msf::Auxiliary::Cisco#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/core/auxiliary/cisco_spec.rb:71 # Msf::Auxiliary::Cisco#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:130 # Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.3 user passwords
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:407 # Msf::Auxiliary::VYOS#vyos_config_eater deals with static ethernet addresses
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:422 # Msf::Auxiliary::VYOS#vyos_config_eater deals with static ethernet addresses with description
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:525 # Msf::Auxiliary::VYOS#vyos_config_eater deals with wireless client
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:94 # Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.1.8 user passwords
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:165 # Msf::Auxiliary::VYOS#vyos_config_eater deals with file not found
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:210 # Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.3 admin password
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:311 # Msf::Auxiliary::VYOS#vyos_config_eater deals with SNMP ro communities
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:244 # Msf::Auxiliary::VYOS#vyos_config_eater deals with admin password with no plaintext field
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:375 # Msf::Auxiliary::VYOS#vyos_config_eater deals with OS Versions old style
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:170 # Msf::Auxiliary::VYOS#vyos_config_eater deals with permission denied
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:343 # Msf::Auxiliary::VYOS#vyos_config_eater deals with SNMP rw communities
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:175 # Msf::Auxiliary::VYOS#vyos_config_eater deals with v1.1.8 admin password
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:479 # Msf::Auxiliary::VYOS#vyos_config_eater deals with wireless server with radius
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:385 # Msf::Auxiliary::VYOS#vyos_config_eater deals with OS Versions new style
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:438 # Msf::Auxiliary::VYOS#vyos_config_eater deals with wireless server
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:278 # Msf::Auxiliary::VYOS#vyos_config_eater deals with masked passwords
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:395 # Msf::Auxiliary::VYOS#vyos_config_eater deals with host names
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:80 # Msf::Auxiliary::VYOS#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/core/auxiliary/vyos_spec.rb:83 # Msf::Auxiliary::VYOS#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session without :host should raise ArgumentError
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host without Mdm::Host should raise ArgumentError
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:7]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:4]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:6]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:5]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:8:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session with :last_seen 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:10:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :closed_at 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:13:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :routes 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:11:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :last_seen without :closed_at 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:11:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session without :last_seen with :closed_at 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:12:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session with :routes 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:2:1:1:1:9:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active without :session with :host with Mdm::Host created Mdm::Session with :closed_at 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session without Msf::Session should raise ArgumentError
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with :workspace should not find workspace from session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:5]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session should set session.db_record to created Mdm::Session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:4]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session should create an Mdm::Session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit should create Mdm::Vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:4:1:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:4:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:7:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without RPORT 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with RPORT 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:5:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:2:5:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:3:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:3:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:3:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:3:4]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:3:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:6:3:5:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt with session.via_exploit 'exploit/multi/handler' with session.datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session with session responds to arch should pass :arch to #find_or_create_host
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:13]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.sid present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:11]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:7]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:16]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:5]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_exploit present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:12]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:8]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:14]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:10]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:6]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_payload present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.platform present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:15]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.info present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:9]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:4]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session should have session.type present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:18:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' should not have session.via_exploit of 'exploit/multi/handler'
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:18:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:17:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' should have session.via_exploit of 'exploit/multi/handler'
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:17:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] should have session.exploit_datastore['ParentModule']
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:7:17:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:3:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data with workspace from either :workspace or session without session responds to arch should not pass :arch to #find_or_create_host
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data without :workspace should find workspace from session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session with a run_id in user_data without :workspace should pass session.workspace to #find_or_create_host
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data without :workspace should pass session.workspace to #find_or_create_host
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data without :workspace should find workspace from session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with :workspace should not find workspace from session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:4]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session should create an Mdm::Session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:5]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session should set session.db_record to created Mdm::Session
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit should create Mdm::Vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:4:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:4:1:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:7:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without RPORT 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln with RPORT 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:5:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:2:5:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::Vuln without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:3:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:3:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:3:4]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:3:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:3:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:6:3:5:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session.via_exploit created Mdm::ExploitAttempt with session.via_exploit 'exploit/multi/handler' with session.datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:9]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:8]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:13]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:10]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:5]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_exploit present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:3]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.platform present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.info present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:11]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.sid present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:12]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:4]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.type present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:7]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:16]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:14]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:6]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session should have session.via_payload present
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:15]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:18:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' should not have session.via_exploit of 'exploit/multi/handler'
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:18:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session without session.via_exploit 'exploit/multi/handler' 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:17:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' should have session.via_exploit of 'exploit/multi/handler'
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:17:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] 
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:7:17:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session returned Mdm::Session with session.via_exploit 'exploit/multi/handler' with session.exploit_datastore['ParentModule'] should have session.exploit_datastore['ParentModule']
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session with session responds to arch should pass :arch to #find_or_create_host
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:1:1:1:2:3:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session with active with :session with Msf::Session without user_data with workspace from either :workspace or session without session responds to arch should not pass :arch to #find_or_create_host
rspec './spec/lib/msf/db_manager_spec.rb[1:21:2:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Session #report_session without active should not create a connection
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated should call module_to_details_hash to get Mdm::Module::Detail attributes and association attributes
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated should create an Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:6:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "exploit" should not raise error
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:5:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "encoder" should not raise error
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:4:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "auxiliary" should not raise error
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:8:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "post" should not raise error
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:7:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated it should behave like Msf::DBManager#update_module_details with module with "nop" should not raise error
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:5:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :ref should create an Mdm::Module::Ref
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:5:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :ref Mdm::Module::Ref 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :author should create an Mdm::Module::Author
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:3:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :author Mdm::Module::Author 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:3:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :author Mdm::Module::Author 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:4:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :platform should create an Mdm::Module::Platform
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:4:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :platform Mdm::Module::Platform 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :arch should create an Mdm::Module::Arch
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :arch Mdm::Module::Arch 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :action should create an Mdm::Module::Action
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :action Mdm::Module::Action 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:6:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :target should create an Mdm::Module::Target
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:6:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :target Mdm::Module::Target 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:2:6:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash with :bits with :target Mdm::Module::Target 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:1:5]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:1:3]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:1:6]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:1:3:1:4]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details with migrated module_to_details_hash Mdm::Module::Detail 
rspec './spec/lib/msf/db_manager_spec.rb[1:15:11:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_module_details without migrated should not create an Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:7:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #purge_all_module_details without migrated should not destroy Mdm::Module::Details
rspec './spec/lib/msf/db_manager_spec.rb[1:15:7:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #purge_all_module_details with migrated with modules_caching should not destroy Mdm::Module::Details
rspec './spec/lib/msf/db_manager_spec.rb[1:15:7:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #purge_all_module_details with migrated without modules_caching should destroy all Mdm::Module::Details
rspec './spec/lib/msf/db_manager_spec.rb[1:15:8:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #remove_module_details without migrated should not destroy Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:8:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #remove_module_details with migrated with matching Mdm::Module::Detail should destroy Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:8:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #remove_module_details with migrated without matching Mdm::Module::Detail should not destroy Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:6:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with os keyword with Mdm::Module::Platform#name should find matching Mdm::Module::Platform#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:6:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with os keyword with Mdm::Module::Target#name should find matching Mdm::Module::Target#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:8:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with ref keyword with Mdm::Module::Ref#name should match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:8:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with ref keyword without Mdm::Module::Ref#name should not match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with author keyword with Mdm::Module::Author#email should match Mdm::Module::Author#email
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with author keyword with Mdm::Module::Author#name should match Mdm::Module::Author#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:5:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with name keyword with Mdm::Module::Detail#fullname should match Mdm::Module::Detail#fullname
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:5:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with name keyword with Mdm::Module::Detail#name should match Mdm::Module::Detail#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:9:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with type keyword with Mdm::Module::Ref#name should match Mdm::Module::Detail#mtype
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:9:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules with type keyword without Mdm::Module::Detail#mtype should not match Mdm::Module::Detail#mtype
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:2:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with bid keyword with Mdm::Module::Ref#name starting with "BID-" should match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:2:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with bid keyword without Mdm::Module::Ref#name starting with "BID-" should not match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:3:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with cve keyword without Mdm::Module::Ref#name starting with "CVE-" should not match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:3:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with cve keyword with Mdm::Module::Ref#name starting with "CVE-" should match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:6:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Ref#name should match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Author#name should match Mdm::Module::Author#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Arch#name should match Mdm::Module::Arch#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Action#name should match Mdm::Module::Action#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:5:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Platform#name should match Mdm::Module::Platform#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:4:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Detail with #description should match Mdm::Module::Detail#description
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:4:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Detail with #name should match Mdm::Module::Detail#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:4:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Detail with #fullname should match Mdm::Module::Detail#fullname
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:10:7:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules without keyword with Mdm::Module::Target#name should match Mdm::Module::Target#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:4:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with edb keyword without Mdm::Module::Ref#name starting with "EDB-" should not match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:4:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Ref#name keyword with edb keyword with Mdm::Module::Ref#name starting with "EDB-" should match Mdm::Module::Ref#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:7:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with platform keyword with Mdm::Module::Platform#name should find matching Mdm::Module::Platform#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:9:7:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #search_modules it should behave like Msf::DBManager#search_modules Mdm::Module::Platform#name or Mdm::Module::Target#name keyword with platform keyword with Mdm::Module::Target#name should find matching Mdm::Module::Target#name
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:3]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching should set modules_caching to true and then false
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching should set framework.cache_thread to current thread and then nil
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching should set modules_cached to false and then true
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh should destroy Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:1:1:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh without cached module in Msf::ModuleSet should not call update_module_details
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:1:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should call update_module_details to create a new Mdm::Module::Detail from the module instance returned by create
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:1:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should create instance of module corresponding to Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:1:1:2:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready false it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet with exception raised by #update_module_details should log error
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:2:1:2:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh should destroy Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:2:1:2:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should call update_module_details to create a new Mdm::Module::Detail from the module instance returned by create
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:2:1:2:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet should create instance of module corresponding to Mdm::Module::Detail
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:2:1:2:1:2:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh with cached module in Msf::ModuleSet with exception raised by #update_module_details should log error
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:2:1:2:1:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file without same Mdm::Module::Detail#mtime and File.mtime it should behave like Msf::DBManager#update_all_module_details refresh without cached module in Msf::ModuleSet should not call update_module_details
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:2:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true with existing Mdm::Module::Detail#file with same Mdm::Module::Detail#mtime and File.mtime should not update module details
rspec './spec/lib/msf/db_manager_spec.rb[1:15:10:1:2:4:1:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ModuleCache #update_all_module_details with migrated without modules_caching with Mdm::Module::Details #ready true without existing Mdm::Module::Detail#file should not update module details
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln should not create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:2:3:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln calling report_exploit_success should not call create_match_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:2:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln calling report_exploit_success should not call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:2:3:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run without a vuln calling report_exploit_success should not call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:1:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln should create a match result with state FAILED
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln should create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:1:4:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln calling report_exploit_success should not call create_match_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:1:4:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln calling report_exploit_success should call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:1:1:4:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure with a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln should not create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:2:3:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln calling report_exploit_success should not call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:2:3:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln calling report_exploit_success should not call create_run_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:2:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run without a vuln calling report_exploit_success should not call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln should not create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:1:3:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln calling report_exploit_success should not call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:1:3:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln calling report_exploit_success should not call create_match_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:4:2:1:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_failure without a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln should not create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:1:3:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln calling report_exploit_success should not call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:1:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:1:3:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run with a vuln calling report_exploit_success should not call create_match_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln should not create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:2:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln calling report_exploit_success should not call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:2:3:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln calling report_exploit_success should not call create_match_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:2:2:3:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success without a run without a vuln calling report_exploit_success should not call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run should not create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:2:3:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run calling report_exploit_success should not call create_match_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:2:3:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run calling report_exploit_success should not call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:2:3:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run without a run calling report_exploit_success should not call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln 
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:1:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln should create a match result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:1:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln should create a match result with state SUCCEEDED
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:1:4:2]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln calling report_exploit_success should call create_match_result
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:1:4:1]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln calling report_exploit_success should call create_match_result_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:6:5:1:1:4:3]' # Msf::DBManager it should behave like Msf::DBManager::ExploitAttempt #report_exploit_success with a run with a vuln calling report_exploit_success should not call create_match_for_vuln
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:4]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :confidence
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:5]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :description
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:7]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :name
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should be a Hash
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:9]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :proof
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:6]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :method
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :blame
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:8]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :pname
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:10]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :risk
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:1:2:3]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element call to #import_msf_web_element specialization return should include :category
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:9:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_vuln_element with required attributes should create an Mdm::WebVuln
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:7:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element call to #import_msf_web_element specialization return should be a Hash
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:7:1:2:3]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element call to #import_msf_web_element specialization return should include :params
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:7:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element call to #import_msf_web_element specialization return should include :method
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:7:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_form_element with required attributes should create an Mdm::WebForm
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element with required attributes should create an Mdm::WebPage
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:7]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :headers
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:6]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :ctype
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:9]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :mtime
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should be a Hash
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:8]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :location
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:3]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :body
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:5]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :cookie
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :auth
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:8:1:2:4]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_web_page_element call to #import_msf_web_element specialization return should include :code
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:3]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type should import all elements in MSF_WEB_TEXT_ELEMENT_NAMES with #import_msf_text_element
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type with :workspace should not call Msf::DBManager#workspace
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:1:2]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type with :workspace should pass :workspace to report_web_<:type>
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:7:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type notifier with :notifier should call :notifier with event and path
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:7:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type notifier without :notifier should not raise an error
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:5:2:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type ssl element with element with 'true' text should pass true for :ssl to report_web_<:type>
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:5:2:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type ssl element with element without 'true' text should pass false for :ssl to report_web_<:type>
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:5:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type ssl element without element should pass false for :ssl to report_web_<:type>
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:6:2]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type specialization block should pass return Hash to report_web_<:type>
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type specialization block should be called with element and options
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:4:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type with non-empty Hash from #import_msf_text_element should pass returned Hash as part of Hash passed to report_web_<:type
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type without :workspace should call Msf::DBManager#workspace
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:6:1:2:2]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML import_msf_web_element with :type without :workspace should pass Msf::DBManager#workspace to report_web_<:type>
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:10:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml should call #check_msf_xml_version!
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:10:4:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml with web_vulns/web_vuln elements should call #import_msf_web_vuln_element
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:10:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml with web_forms/web_form elements should call #import_msf_web_form_element
rspec './spec/lib/msf/db_manager_spec.rb[1:12:22:4:10:3:1]' # Msf::DBManager it should behave like Msf::DBManager::Import it should behave like Msf::DBManager::Import::MetasploitFramework it should behave like Msf::DBManager::Import::MetasploitFramework::XML #import_msf_xml with web_pages/web_page elements should call #import_msf_web_page_element
rspec './spec/lib/msf/db_manager_spec.rb[1:14:5:1]' # Msf::DBManager it should behave like Msf::DBManager::Migration #reset_column_information should use ApplicationRecord.descendants to find both direct and indirect subclasses
rspec './spec/lib/msf/db_manager_spec.rb[1:14:5:2]' # Msf::DBManager it should behave like Msf::DBManager::Migration #reset_column_information should reset column information on each descendant of ApplicationRecord
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:2]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate should return an ActiveRecord::MigrationContext with known migrations
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:1]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate should create an ActiveRecord::MigrationContext
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:3]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate should reset the column information
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:6:1]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate without verbose should set ActiveRecord::Migration.verbose to false
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:5:2:1]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with verbose true should set ActiveRecord::Migration.verbose to true
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:5:1:1]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with verbose false should set ActiveRecord::Migration.verbose to false
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:4:2]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with StandardError from ActiveRecord::MigrationContext.migrate should log error message at error level
rspec './spec/lib/msf/db_manager_spec.rb[1:14:3:4:1]' # Msf::DBManager it should behave like Msf::DBManager::Migration #migrate with StandardError from ActiveRecord::MigrationContext.migrate should set Msf::DBManager#error
rspec ./spec/lib/rex/proto/kademlia/bootstrap_response_spec.rb:8 # Rex::Proto::Kademlia::BootstrapResponse#from_data properly decodes real valid bootstrap responses
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:84 # Msf::Exploit::AutoTarget finding the target host should return nil if there is not one
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:76 # Msf::Exploit::AutoTarget finding the target host should return a matching Mdm::host if there is one
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:64 # Msf::Exploit::AutoTarget#auto_target? should return false if the automatic target is not selected
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:55 # Msf::Exploit::AutoTarget#auto_target? should return true if the automatic target is selected
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:35 # Msf::Exploit::AutoTarget adding an Automatic target an exploit without an existing Automatic target should have an Automatic target added to the top of the list
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:146 # Msf::Exploit::AutoTarget filtering targets #filter_by_os should return an array of matching targets
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:150 # Msf::Exploit::AutoTarget filtering targets #filter_by_os should fall back to previous filter levels if a more strict filter did not return results
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:156 # Msf::Exploit::AutoTarget filtering targets #select_target should return the matching target on a precise match
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:162 # Msf::Exploit::AutoTarget filtering targets #select_target should return the first match on a less precise match
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:135 # Msf::Exploit::AutoTarget filtering targets by OS Version/Service Pack should return an empty array if there are no matching results
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:131 # Msf::Exploit::AutoTarget filtering targets by OS Version/Service Pack should return an array of matching results if they exist
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:139 # Msf::Exploit::AutoTarget filtering targets by OS Version/Service Pack should return an empty array if there is no SP
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:170 # Msf::Exploit::AutoTarget filtering targets #auto_targeted_index should return the index of the selected target
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:176 # Msf::Exploit::AutoTarget filtering targets #auto_targeted_index should return nil if it does not find a match
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:105 # Msf::Exploit::AutoTarget filtering targets by OS family should return an empty array if there are no matches
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:109 # Msf::Exploit::AutoTarget filtering targets by OS family should return nil if the os is unkown on the host
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:101 # Msf::Exploit::AutoTarget filtering targets by OS family should return an array of all matching targets
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:117 # Msf::Exploit::AutoTarget filtering targets by OS Name should return an array of matching targets when any exist
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:121 # Msf::Exploit::AutoTarget filtering targets by OS Name should return an empty array if there are no matches
rspec ./spec/lib/msf/core/exploit/auto_target_spec.rb:125 # Msf::Exploit::AutoTarget filtering targets by OS Name should return an empty array when there is no OS name
rspec './spec/lib/msf/core/module_manager_spec.rb[1:1:8:2:1]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache should create cache entry for path
rspec './spec/lib/msf/core/module_manager_spec.rb[1:1:8:2:2:2]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
rspec './spec/lib/msf/core/module_manager_spec.rb[1:1:8:2:2:1]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
rspec './spec/lib/msf/core/module_manager_spec.rb[1:1:8:2:2:4]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
rspec './spec/lib/msf/core/module_manager_spec.rb[1:1:8:2:2:3]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache cache entry 
rspec './spec/lib/msf/core/module_manager_spec.rb[1:1:8:2:3:1:1]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache typed module set with reference_name should not change reference_name value
rspec './spec/lib/msf/core/module_manager_spec.rb[1:1:8:2:3:2:1]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Cache #module_info_by_path_from_database! with database cache typed module set without reference_name should set reference_name value to Msf::SymbolicModule
rspec './spec/lib/msf/core/module_manager_spec.rb[1:2:3:1]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should add module to type's module_set
rspec './spec/lib/msf/core/module_manager_spec.rb[1:2:3:3]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should pass class to #auto_subscribe_module
rspec './spec/lib/msf/core/module_manager_spec.rb[1:2:3:4]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should fire on_module_load event with class
rspec './spec/lib/msf/core/module_manager_spec.rb[1:2:3:2]' # Msf::ModuleManager it should behave like Msf::ModuleManager::Loading #on_module_load should call cache_in_memory
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:2:2]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types db2db does not create a core if it already exists
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:2:1]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types db2db creates a core if one does not exist
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:3:2]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types sid does not create a core if it already exists
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:3:1]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types sid creates a core if one does not exist
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:1:2]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types domain does not create a core if it already exists
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:1:1]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types domain creates a core if one does not exist
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:4:1]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types pgdb creates a core if one does not exist
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:4:2]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types pgdb does not create a core if it already exists
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:5:1]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types rsync creates a core if one does not exist
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:5:2]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types rsync does not create a core if it already exists
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:6:2]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types wildcard does not create a core if it already exists
rspec './spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb[1:4:2:1:7:6:1]' # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms realm-types wildcard creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:402 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ssh-key does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:397 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ssh-key creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:354 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ntlm creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:359 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types ntlm does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:378 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types hash does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:373 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types hash creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:340 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types password does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:335 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms private_types password creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:241 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username password and realm creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:246 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username password and realm does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:302 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms password and realm does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:297 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms password and realm creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:264 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and realm does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:259 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and realm creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:321 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:316 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:278 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and password creates a core if one does not exist
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:283 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with public privates and realms username and password does not create a core if it already exists
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:459 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a host
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:456 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a service
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:450 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a core
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:453 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Adding Cores with Logins With valid params creates a login
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:217 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -t with valid types ntlm should show just the ntlm
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:202 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -t with valid types password should show just the password
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:122 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is absent due to a nonmatching username should return a blank set
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:134 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is absent due to a nonmatching password should return a blank set
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:80 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present should not match a regular expression
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:68 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present should show a user that matches the given expression
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:93 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present and when the username is blank should show a user that matches the given expression
rspec ./spec/lib/msf/ui/console/command_dispatcher/creds_spec.rb:106 # Msf::Ui::Console::CommandDispatcher::Creds#cmd_creds Searching -u when the credential is present and when the password is blank should show a user that matches the given expression
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:82 # Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with admin credentials
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:105 # Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with user account with password hash
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:185 # Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with ppp configurations
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:217 # Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with ike configurations
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:141 # Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with snmp-server community with Read permission
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:162 # Msf::Auxiliary::Juniper#juniper_screenos_config_eater deals with snmp-server community with Read-Write permission
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:565 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with pap
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:534 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with radius
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:249 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with root credentials
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:402 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with unauthorized
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:282 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with super-user
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:362 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with read-only
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:322 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with user account with password hash with operator
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:446 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with snmp-server community with Read permissions
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:474 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with snmp-server community with Read-Write permissions and view
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:503 # Msf::Auxiliary::Juniper#juniper_junos_config_eater deals with snmp-server community with a space in the community string
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:71 # Msf::Auxiliary::Juniper#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec ./spec/lib/msf/core/auxiliary/juniper_spec.rb:68 # Msf::Auxiliary::Juniper#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:486 # Msf::Auxiliary::Ubiquiti handles firewallgroups prints correctly
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:284 # Msf::Auxiliary::Ubiquiti handles snmp v3 disabled
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:255 # Msf::Auxiliary::Ubiquiti handles snmp v3 enabled
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:199 # Msf::Auxiliary::Ubiquiti handles snmp v2 enabled
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:227 # Msf::Auxiliary::Ubiquiti handles snmp v2 disabled
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:528 # Msf::Auxiliary::Ubiquiti handles user devices report_host correctly
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:107 # Msf::Auxiliary::Ubiquiti deals with admin users
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:355 # Msf::Auxiliary::Ubiquiti handles ssh configurations with passwords
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:383 # Msf::Auxiliary::Ubiquiti handles ssh configurations with keys
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:179 # Msf::Auxiliary::Ubiquiti handles firewall rules printing
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:452 # Msf::Auxiliary::Ubiquiti handles wifi with wpa2
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:72 # Msf::Auxiliary::Ubiquiti#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:75 # Msf::Auxiliary::Ubiquiti#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:141 # Msf::Auxiliary::Ubiquiti deals with radius configurations with internal configurations
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:82 # Msf::Auxiliary::Ubiquiti converts bson to json handles nil
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:87 # Msf::Auxiliary::Ubiquiti converts bson to json handles empty string
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:92 # Msf::Auxiliary::Ubiquiti converts bson to json correctly with admin and radius
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:332 # Msf::Auxiliary::Ubiquiti handles ntp servers that are not default
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:319 # Msf::Auxiliary::Ubiquiti handles ntp servers from ubiquiti
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:418 # Msf::Auxiliary::Ubiquiti handles mesh handles mesh configurations
rspec ./spec/lib/msf/core/auxiliary/ubiquiti_spec.rb:506 # Msf::Auxiliary::Ubiquiti handles devices report_host correctly
rspec ./spec/lib/rex/proto/acpp/message_spec.rb:40 # Rex::Proto::ACPP::Message#to_s encodes properly
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:726 # Msf::Auxiliary::Mikrotik RouterOS deals with PPP tunnel bridging details saves non-disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:758 # Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WEP correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:825 # Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details handles open wifi correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:861 # Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WPA2 correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:886 # Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WPA-EAP correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:836 # Msf::Auxiliary::Mikrotik RouterOS deals with Wireless details saves WPA correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:634 # Msf::Auxiliary::Mikrotik RouterOS deals with SMB user details saves non-disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:661 # Msf::Auxiliary::Mikrotik RouterOS deals with SMB user details saves disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:312 # Msf::Auxiliary::Mikrotik RouterOS deals with OpenVPN Client details saves non-disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:339 # Msf::Auxiliary::Mikrotik RouterOS deals with OpenVPN Client details saves disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:694 # Msf::Auxiliary::Mikrotik RouterOS deals with SMTP User details saves non-disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:95 # Msf::Auxiliary::Mikrotik SwOS gets blank password
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:121 # Msf::Auxiliary::Mikrotik SwOS gets password
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:174 # Msf::Auxiliary::Mikrotik SwOS prints interface 24 name only
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:185 # Msf::Auxiliary::Mikrotik SwOS gets snmp password
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:147 # Msf::Auxiliary::Mikrotik SwOS gets ip address
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:162 # Msf::Auxiliary::Mikrotik SwOS gets hostname
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:516 # Msf::Auxiliary::Mikrotik RouterOS deals with PPTP Client details saves disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:489 # Msf::Auxiliary::Mikrotik RouterOS deals with PPTP Client details saves non-disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:262 # Msf::Auxiliary::Mikrotik RouterOS converts settings to hash handles nil
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:267 # Msf::Auxiliary::Mikrotik RouterOS converts settings to hash handles empty string
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:272 # Msf::Auxiliary::Mikrotik RouterOS converts settings to hash correctly with several values
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:212 # Msf::Auxiliary::Mikrotik RouterOS converts export to hash handles nil
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:222 # Msf::Auxiliary::Mikrotik RouterOS converts export to hash correctly with several values
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:243 # Msf::Auxiliary::Mikrotik RouterOS converts export to hash correctly with several terse values
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:217 # Msf::Auxiliary::Mikrotik RouterOS converts export to hash handles empty string
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:457 # Msf::Auxiliary::Mikrotik RouterOS deals with L2TP Client details saves disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:430 # Msf::Auxiliary::Mikrotik RouterOS deals with L2TP Client details saves non-disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:371 # Msf::Auxiliary::Mikrotik RouterOS deals with PPPoE Client details saves non-disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:398 # Msf::Auxiliary::Mikrotik RouterOS deals with PPPoE Client details saves disabled correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:81 # Msf::Auxiliary::Mikrotik#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:84 # Msf::Auxiliary::Mikrotik#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:282 # Msf::Auxiliary::Mikrotik RouterOS deals with OS details saves OS correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:295 # Msf::Auxiliary::Mikrotik RouterOS deals with OS details saves hostname correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:602 # Msf::Auxiliary::Mikrotik RouterOS deals with SNMP details saves v3 RO correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:548 # Msf::Auxiliary::Mikrotik RouterOS deals with SNMP details saves RW correct
rspec ./spec/lib/msf/core/auxiliary/mikrotik_spec.rb:575 # Msf::Auxiliary::Mikrotik RouterOS deals with SNMP details saves RO correct
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:74 # Msf::Auxiliary::Brocade#create_credential_and_login associates the Metasploit::Credential::Core with a task if passed
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:71 # Msf::Auxiliary::Brocade#create_credential_and_login creates a Metasploit::Credential::Login
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:133 # Msf::Auxiliary::Brocade#brocade_config_eater deals with snmp communities
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:171 # Msf::Auxiliary::Brocade#brocade_config_eater deals with snmp communities
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:85 # Msf::Auxiliary::Brocade#brocade_config_eater deals with enable passwords
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:109 # Msf::Auxiliary::Brocade#brocade_config_eater deals with user passwords
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:163 # Msf::Auxiliary::Brocade#brocade_config_eater deals with user hidden passwords
rspec ./spec/lib/msf/core/auxiliary/brocade_spec.rb:155 # Msf::Auxiliary::Brocade#brocade_config_eater deals with enable hidden passwords
rspec ./spec/api/json_rpc_spec.rb:142 # Metasploit's json-rpc Running a check job and verifying results when the check command raises a known msf error returns the error results
rspec ./spec/api/json_rpc_spec.rb:107 # Metasploit's json-rpc Running a check job and verifying results when the module returns check code safe returns successful job results
rspec ./spec/api/json_rpc_spec.rb:174 # Metasploit's json-rpc Running a check job and verifying results when the check command has an unexpected error returns the error results
rspec ./spec/lib/rex/proto/kerberos/model/encrypted_data_spec.rb:154 # Rex::Proto::Kerberos::Model::EncryptedData#encode when EncryptedData without kvno encodes Rex::Proto::Kerberos::Model::EncryptedData correctly
rspec ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:113 # Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job fails should show as finished
rspec ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:118 # Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job fails should have a retrievable result
rspec ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:155 # Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job result is not serializable should show as finished
rspec ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:160 # Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job result is not serializable should have an error result
rspec ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:72 # Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job completes successfully should have a retrievable result
rspec ./spec/lib/msf/core/rpc/v10/rpc_job_status_tracker_spec.rb:67 # Msf::RPC::RpcJobStatusTracker With default options A job is waiting The job is started The job completes successfully should show as finished
rspec ./spec/lib/msf/core/module_set_spec.rb:51 # Msf::ModuleSet#rank_modules with Msf::SymbolicModule create returns nil 
rspec ./spec/lib/msf/core/module_set_spec.rb:57 # Msf::ModuleSet#rank_modules with Msf::SymbolicModule create returns nil is ranked as Manual
rspec ./spec/lib/msf/core/module_set_spec.rb:122 # Msf::ModuleSet#rank_modules with Msf::SymbolicModule create does not return nil without Rank is ranked as Normal
rspec ./spec/lib/msf/core/module_set_spec.rb:99 # Msf::ModuleSet#rank_modules with Msf::SymbolicModule create does not return nil with Rank is ranked using Rank
rspec ./spec/lib/msf/core/module_set_spec.rb:175 # Msf::ModuleSet#rank_modules without Msf::SymbolicModule with Rank is ranked using Rank
rspec ./spec/lib/msf/core/module_set_spec.rb:198 # Msf::ModuleSet#rank_modules without Msf::SymbolicModule without Rank is ranked as Normal
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:165 # Msf::Ui::Console::CommandDispatcher::Db#cmd_notes -h should show a help message
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:55 # Msf::Ui::Console::CommandDispatcher::Db#cmd_db_export -h should show a help message
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:229 # Msf::Ui::Console::CommandDispatcher::Db#cmd_services -p should list services that are on a given port
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:260 # Msf::Ui::Console::CommandDispatcher::Db#cmd_services -np should list services that are not on a given port
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:68 # Msf::Ui::Console::CommandDispatcher::Db#cmd_db_import -h should show a help message
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:308 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace <no arguments> should list default workspace
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:315 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace <no arguments> should list all workspaces
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:377 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -D should delete all workspaces
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:386 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -h should show a help message
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:356 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -a should add workspaces
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:368 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -d should delete a workspace
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:327 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -v should list default workspace verbosely
rspec ./spec/lib/msf/ui/console/command_dispatcher/db_spec.rb:339 # Msf::Ui::Console::CommandDispatcher::Db#cmd_workspace -v should list all workspaces verbosely

Randomized with seed 48928
Coverage report generated for RSpec to /Users/adfoster/Documents/code/metasploit-framework/coverage. 58037 / 107438 LOC (54.02%) covered.
SimpleCov failed with exit 1
➜  metasploit-framework git:(ruby-3.0-spike) ✗ 
